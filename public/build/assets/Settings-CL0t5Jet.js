import{a4 as B,r as o,k as T,h as d,d as l,x as D,p as h,e as t,$ as k,c as w,F,l as j,y as E,t as S,j as p,a3 as U}from"./vendor-BOi6Gr0G.js";import{A as G,s as V}from"./AuthenticatedLayout-ySbiGZ3w.js";import{z as L,A as O}from"./ui-BibPgP1I.js";import{B as W}from"./index-Btbp3Gjs.js";import q from"./GeneralSettings-BOMlZkqt.js";import H from"./SecuritySettings-BmwAPJmD.js";import M from"./NotificationSettings-DSaDlikZ.js";import P from"./CorporateSettings-emlntjtl.js";import J from"./DatabaseSettings-B6Q-I3w_.js";import K from"./UnsavedChangesModal-DD-4TYnm.js";import"./logo-DN1bLr27.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useUnsavedChanges-KICSwIyp.js";const Q={class:"container mx-auto px-2 sm:px-4 py-4 sm:py-6 lg:py-8"},X={class:"bg-white rounded-lg shadow-lg overflow-hidden"},Y={class:"bg-gradient-to-r from-red-600 to-red-700 px-2 sm:px-4 lg:px-6 py-2 sm:py-3 lg:py-4"},Z={class:"text-sm sm:text-lg lg:text-2xl font-bold text-white flex items-center"},ee={class:"flex flex-col lg:flex-row min-h-screen"},se={class:"w-full lg:w-80 bg-gray-50 border-b lg:border-b-0 lg:border-r border-gray-200 p-2 sm:p-4 lg:p-6"},te={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-1 gap-1 sm:gap-2 lg:space-y-2 lg:gap-0"},ae=["onClick"],ie={class:"text-sm sm:text-lg lg:text-xl mb-0.5 sm:mb-1 lg:mb-0 lg:mr-3"},oe={class:"flex-1"},ne={class:"font-medium text-xs sm:text-sm lg:text-base"},le={class:"flex-1 p-2 sm:p-4 lg:p-6"},Se={__name:"Settings",props:{siteSettings:{type:Object,default:()=>({})},companyValues:{type:Array,default:()=>[]},databaseInfo:{type:Object,default:()=>({last_backup_formatted:"No disponible",database_size:"No disponible",status:"unknown",status_text:"Desconocido"})}},setup(C){B();const y=L(),f=C,r=o(!1),a=o("general"),b=o(f.companyValues),_=o(!1),u=o(!1),m=o(null),N=s=>{_.value?(m.value=s,u.value=!0):a.value=s},I=()=>{_.value=!1,u.value=!1,m.value&&(a.value=m.value,m.value=null)},$=()=>{u.value=!1,m.value=null},g=s=>{_.value=s},R=o([{id:"general",icon:"⚙️",title:"Configuración General",description:"Información básica del sistema"},{id:"security",icon:"🔐",title:"Seguridad",description:"Configuraciones de seguridad"},{id:"notifications",icon:"📧",title:"Notificaciones",description:"Gestión de comunicaciones"},{id:"corporate",icon:"🏢",title:"Información Corporativa",description:"Contenido empresarial"},{id:"database",icon:"💾",title:"Base de Datos",description:"Respaldos y mantenimiento"}]),e=o({mission:f.siteSettings.mission||"",vision:f.siteSettings.vision||"",description:f.siteSettings.description||"",systemName:"Sistema VASIR",version:"1.0.0",contactEmail:"contacto@vasir.com",contactPhone:"+505 8888-8888",requireEmailVerification:!0,enableTwoFactor:!1,sessionTimeout:120,emailNotifications:!0,smsNotifications:!1,smtpServer:"smtp.gmail.com"}),c=o({...e.value}),x=async()=>{r.value=!0;try{await U.post(V("settings.update"),{mission:e.value.mission,vision:e.value.vision,description:e.value.description},{onSuccess:s=>{c.value.mission=e.value.mission,c.value.vision=e.value.vision,c.value.description=e.value.description,y.add({severity:"success",summary:"¡Éxito!",detail:"Configuración de la empresa actualizada correctamente",life:3e3})},onError:s=>{console.error("Error al guardar la configuración:",s),y.add({severity:"error",summary:"Error",detail:"Error al guardar la configuración",life:5e3})}})}catch(s){console.error("Error al guardar la configuración:",s),y.add({severity:"error",summary:"Error",detail:"Error al guardar la configuración",life:5e3})}finally{r.value=!1}},v=()=>{confirm("¿Está seguro de restablecer todos los cambios?")&&(e.value={...c.value})},z=()=>{console.log("🔄 Iniciando recarga de settings..."),U.get(V("settings"),{},{preserveState:!1,preserveScroll:!0,only:["siteSettings","companyValues"],onSuccess:s=>{console.log("✅ Datos recargados exitosamente:",s.props),e.value.mission=s.props.siteSettings.mission||"",e.value.vision=s.props.siteSettings.vision||"",e.value.description=s.props.siteSettings.description||"",c.value.mission=e.value.mission,c.value.vision=e.value.vision,c.value.description=e.value.description,b.value=s.props.companyValues,console.log("📊 Settings actualizados:",e.value),console.log("🏢 Company values actualizados:",b.value)},onError:s=>{console.error("❌ Error al recargar settings:",s)}})};return(s,n)=>{const A=T("Toast");return l(),d(G,null,{default:D(()=>[h(A),t("div",Q,[t("div",X,[t("div",Y,[t("h1",Z,[h(k(O),{icon:k(W),class:"mr-1 sm:mr-2 lg:mr-3 text-sm sm:text-base lg:text-xl"},null,8,["icon"]),n[1]||(n[1]=t("span",{class:"hidden sm:inline"},"Configuración del Sistema",-1)),n[2]||(n[2]=t("span",{class:"sm:hidden"},"Configuración del sistema",-1))]),n[3]||(n[3]=t("p",{class:"text-red-100 mt-0.5 sm:mt-1 lg:mt-2 text-xs sm:text-sm lg:text-base hidden sm:block"},"Configure los parámetros generales del sistema",-1))]),t("div",ee,[t("div",se,[t("nav",te,[(l(!0),w(F,null,j(R.value,i=>(l(),w("button",{key:i.id,onClick:re=>N(i.id),class:E(["w-full flex flex-col lg:flex-row items-center lg:items-center px-1.5 sm:px-3 py-1.5 sm:py-2 lg:px-4 lg:py-3 text-center lg:text-left rounded-lg transition-all duration-200",a.value===i.id?"bg-red-600 text-white shadow-md":"text-gray-700 hover:bg-red-50 hover:text-red-700"])},[t("span",ie,S(i.icon),1),t("div",oe,[t("div",ne,S(i.title),1),t("div",{class:E(["text-xs hidden lg:block",a.value===i.id?"text-red-100":"text-gray-500"])},S(i.description),3)])],10,ae))),128))])]),t("div",le,[a.value==="general"?(l(),d(q,{key:0,settings:e.value,"is-saving":r.value,onSave:x,onReset:v,onUnsavedChanges:g},null,8,["settings","is-saving"])):p("",!0),a.value==="security"?(l(),d(H,{key:1,settings:e.value,"is-saving":r.value,onSave:x,onReset:v,onUnsavedChanges:g},null,8,["settings","is-saving"])):p("",!0),a.value==="notifications"?(l(),d(M,{key:2,settings:e.value,"is-saving":r.value,onSave:x,onReset:v,onUnsavedChanges:g},null,8,["settings","is-saving"])):p("",!0),a.value==="corporate"?(l(),d(P,{key:3,settings:e.value,"company-values":b.value,"is-saving":r.value,onReset:v,onUnsavedChanges:g,onSettingsUpdated:z},null,8,["settings","company-values","is-saving"])):p("",!0),a.value==="database"?(l(),d(J,{key:4,"database-info":C.databaseInfo,"is-saving":r.value,onSave:x,onReset:v,onUnsavedChanges:g},null,8,["database-info","is-saving"])):p("",!0)])])])]),h(K,{visible:u.value,"onUpdate:visible":n[0]||(n[0]=i=>u.value=i),onContinueEditing:$,onExitWithoutSaving:I},null,8,["visible"])]),_:1})}}};export{Se as default};
