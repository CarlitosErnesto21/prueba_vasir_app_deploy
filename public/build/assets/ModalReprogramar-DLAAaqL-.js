import{b as T,r as D,w as U,E as V,k as m,h as M,d as l,x as C,c as n,j as u,e,t as c,p,y as v,q as f}from"./vendor-BOi6Gr0G.js";const A={key:0,class:"p-6"},z={class:"bg-gray-50 rounded-lg p-4 mb-6"},H={class:"grid grid-cols-2 gap-4 text-sm"},G={class:"block text-gray-900"},J={class:"block text-gray-900"},K={class:"block text-gray-900"},Q={class:"block text-gray-900 font-medium"},W={class:"space-y-6"},X={key:0,class:"text-red-600 mt-1 block"},Y={key:0,class:"text-red-600 mt-1 block"},Z={class:"block text-sm font-medium text-gray-700 mb-2"},$={key:0,class:"text-red-500"},ee={key:0,class:"text-red-600 mt-1 block"},ae={key:1,class:"text-gray-500 mt-1 block"},oe={class:"flex justify-between"},te=["disabled"],se=["disabled"],re={key:0},le={key:1},ie={__name:"ModalReprogramar",props:{visible:{type:Boolean,default:!1},reserva:{type:Object,default:()=>null}},emits:["update:visible","confirmarReprogramacion"],setup(r,{emit:S}){const g=r,y=S,o=T({fecha_nueva:null,motivo:"",observaciones:""}),s=D({}),i=D(!1),R=["Cancelación del tour por parte de la agencia","Solicitud del cliente","Condiciones climáticas adversas","Problemas de transporte","Otro motivo"];U(()=>g.reserva,t=>{t&&(o.fecha_nueva=null,o.motivo="",o.observaciones="",s.value={})},{deep:!0});const O=V(()=>{const t=new Date;return t.setDate(t.getDate()+1),t}),E=V(()=>o.fecha_nueva&&o.motivo&&Object.keys(s.value).length===0),q=()=>{const t={};return o.fecha_nueva?new Date(o.fecha_nueva)<=new Date&&(t.fecha_nueva="La fecha debe ser posterior a hoy"):t.fecha_nueva="La nueva fecha es requerida",o.motivo||(t.motivo="El motivo es requerido"),o.motivo==="Otro motivo"&&!o.observaciones&&(t.observaciones='Las observaciones son requeridas cuando se selecciona "Otro motivo"'),s.value=t,Object.keys(t).length===0},F=t=>t?new Date(t).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}):"-",N=t=>new Intl.NumberFormat("es-ES",{style:"currency",currency:"USD"}).format(t||0),b=()=>{o.fecha_nueva=null,o.motivo="",o.observaciones="",s.value={},i.value=!1,y("update:visible",!1)},P=async()=>{if(q()){i.value=!0;try{const t={reserva_id:g.reserva.id,fecha_nueva:o.fecha_nueva,motivo:o.motivo,observaciones:o.observaciones};y("confirmarReprogramacion",t),b()}catch(t){console.error("Error al reprogramar:",t)}finally{i.value=!1}}};return(t,a)=>{const j=m("DatePicker"),B=m("Select"),I=m("Textarea"),L=m("Dialog");return l(),M(L,{visible:r.visible,"onUpdate:visible":b,modal:"",header:"Reprogramar Reserva",style:{width:"600px"},draggable:!1,position:"center",pt:{root:{class:"rounded-lg border border-gray-200"},header:{class:"bg-red-50 border-b px-6 py-4"},content:{class:"p-0"},footer:{class:"border-t px-6 py-4 bg-gray-50"}}},{footer:C(()=>[e("div",oe,[e("button",{class:"bg-gray-500 border border-gray-500 text-white shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300 px-4 py-2 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",onClick:b,disabled:i.value},a[12]||(a[12]=[e("i",{class:"pi pi-times"},null,-1),f(" Cancelar ")]),8,te),e("button",{class:"bg-yellow-500 border border-yellow-500 text-white shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300 px-4 py-2 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",onClick:P,disabled:!E.value||i.value},[e("i",{class:v(["pi pi-calendar",{"animate-spin":i.value}])},null,2),i.value?(l(),n("span",re,"Procesando...")):(l(),n("span",le,"Confirmar Reprogramación"))],8,se)])]),default:C(()=>{var h,x,k,w,_;return[r.reserva?(l(),n("div",A,[e("div",z,[a[7]||(a[7]=e("h4",{class:"font-medium text-gray-900 mb-3"},"Información Actual",-1)),e("div",H,[e("div",null,[a[3]||(a[3]=e("span",{class:"font-medium text-gray-600"},"Cliente:",-1)),e("span",G,c(((x=(h=r.reserva.cliente)==null?void 0:h.user)==null?void 0:x.name)||((k=r.reserva.cliente)==null?void 0:k.nombres)||"-"),1)]),e("div",null,[a[4]||(a[4]=e("span",{class:"font-medium text-gray-600"},"Fecha Actual:",-1)),e("span",J,c(F(r.reserva.fecha_reserva)),1)]),e("div",null,[a[5]||(a[5]=e("span",{class:"font-medium text-gray-600"},"Tour/Hotel:",-1)),e("span",K,c(((w=r.reserva.tour)==null?void 0:w.nombre)||((_=r.reserva.hotel)==null?void 0:_.nombre)||"-"),1)]),e("div",null,[a[6]||(a[6]=e("span",{class:"font-medium text-gray-600"},"Precio Total:",-1)),e("span",Q,c(N(r.reserva.precio_total)),1)])])]),e("div",W,[e("div",null,[a[8]||(a[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Nueva Fecha * ",-1)),p(j,{modelValue:o.fecha_nueva,"onUpdate:modelValue":a[0]||(a[0]=d=>o.fecha_nueva=d),minDate:O.value,placeholder:"Seleccionar nueva fecha...",dateFormat:"dd/mm/yy",class:v(["w-full",{"p-invalid":s.value.fecha_nueva}]),showIcon:""},null,8,["modelValue","minDate","class"]),s.value.fecha_nueva?(l(),n("small",X,c(s.value.fecha_nueva),1)):u("",!0)]),e("div",null,[a[9]||(a[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Motivo de la Reprogramación * ",-1)),p(B,{modelValue:o.motivo,"onUpdate:modelValue":a[1]||(a[1]=d=>o.motivo=d),options:R,placeholder:"Seleccionar motivo...",class:v(["w-full",{"p-invalid":s.value.motivo}])},null,8,["modelValue","class"]),s.value.motivo?(l(),n("small",Y,c(s.value.motivo),1)):u("",!0)]),e("div",null,[e("label",Z,[a[10]||(a[10]=f(" Observaciones ")),o.motivo==="Otro motivo"?(l(),n("span",$,"*")):u("",!0)]),p(I,{modelValue:o.observaciones,"onUpdate:modelValue":a[2]||(a[2]=d=>o.observaciones=d),placeholder:"Detalles adicionales sobre la reprogramación...",rows:"3",class:v(["w-full",{"p-invalid":s.value.observaciones}])},null,8,["modelValue","class"]),s.value.observaciones?(l(),n("small",ee,c(s.value.observaciones),1)):(l(),n("small",ae," Información adicional que será enviada al cliente "))]),a[11]||(a[11]=e("div",{class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},[e("div",{class:"flex"},[e("i",{class:"pi pi-exclamation-triangle text-yellow-400 mr-2 mt-0.5"}),e("div",{class:"text-sm text-yellow-800"},[e("strong",null,"Importante:"),f(" La reprogramación será notificada automáticamente al cliente por correo electrónico. Asegúrate de que la nueva fecha esté disponible antes de confirmar. ")])])],-1))])])):u("",!0)]}),_:1},8,["visible"])}}};export{ie as default};
