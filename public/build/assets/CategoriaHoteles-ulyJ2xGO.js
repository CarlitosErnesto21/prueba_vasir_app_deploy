import{r as d,w as X,n as L,o as Q,N as _,k as w,c as k,d as E,p as o,$ as s,a0 as Y,x as n,e as a,a1 as Z,t as y,q as b,j as A,y as ee,F as ae}from"./vendor-BOi6Gr0G.js";import{A as te}from"./AuthenticatedLayout-ySbiGZ3w.js";import{z as se,A as i}from"./ui-BibPgP1I.js";import{f as oe,a as le,b as U,c as re,d as j,e as V,g as $,h as ne}from"./index-Btbp3Gjs.js";import"./logo-DN1bLr27.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ie={class:"py-4 sm:py-6 px-4 sm:px-7 mt-6 sm:mt-10 mx-auto bg-red-50 shadow-md rounded-lg h-screen-full"},de={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 gap-2 sm:gap-0"},ue={class:"flex items-center gap-3"},me={class:"text-sm font-medium leading-relaxed"},ce={class:"flex gap-1 justify-center items-center w-64"},ge=["onClick"],ve=["onClick"],be={class:"space-y-4"},fe={class:"w-full flex flex-col"},pe={class:"flex items-center gap-4"},xe={key:0,class:"text-red-500 ml-28"},he={key:1,class:"text-orange-500 ml-28"},we={key:2,class:"text-red-500 ml-28"},ye={class:"flex justify-center gap-4 w-full"},Ce={class:"flex items-center gap-3"},Pe={class:"flex flex-col"},_e={class:"flex justify-center gap-4 w-full"},ke={class:"flex items-center gap-3"},Ee={class:"flex justify-center gap-3 w-full"},Ue={__name:"CategoriaHoteles",setup(Te){const c=se(),S=d([]),t=d({id:null,nombre:""}),g=d(!1),f=d(!1),h=d(!1),p=d(!1),x=d(!1),v=d(null),T=d(10),z=d([5,10,20,50]),C=d("Guardar");X([t],()=>{v.value&&g.value&&L(()=>{const l={...t.value},e=JSON.stringify(l)!==JSON.stringify(v.value),u=!v.value.id,m=t.value.nombre;x.value=e||u&&m})},{deep:!0,flush:"post"});function P(){t.value={id:null,nombre:""},p.value=!1}Q(()=>{D()});const D=async()=>{try{const l=await _.get("/api/categorias-hoteles");S.value=(l.data.data||l.data||[]).map(e=>({...e,categoria_id:e.id})).sort((e,u)=>new Date(u.created_at)-new Date(e.created_at))}catch{c.add({severity:"error",summary:"Error",detail:"No se pudieron cargar las categorías de hoteles.",life:4e3})}},F=()=>{P(),C.value="Guardar",p.value=!1,g.value=!0,L(()=>{v.value={...t.value},x.value=!1})},R=l=>{P(),p.value=!1,t.value={...l},C.value="Actualizar",g.value=!0,L(()=>{v.value={...t.value},x.value=!1})},I=async()=>{var l,e;if(p.value=!0,!t.value.nombre||t.value.nombre.length<3||t.value.nombre.length>50){c.add({severity:"warn",summary:"Campos requeridos",detail:"El nombre debe tener entre 3 y 50 caracteres.",life:4e3});return}try{t.value.id?(await _({method:"POST",url:`/api/categorias-hoteles/${t.value.id}`,data:{_method:"PUT",nombre:t.value.nombre}}),c.add({severity:"success",summary:"¡Éxito!",detail:"La categoría ha sido actualizada correctamente.",life:5e3})):(await _.post("/api/categorias-hoteles",{nombre:t.value.nombre}),c.add({severity:"success",summary:"¡Éxito!",detail:"La categoría ha sido creada correctamente.",life:5e3})),await D(),g.value=!1,x.value=!1,v.value=null,P()}catch(u){const m=((e=(l=u.response)==null?void 0:l.data)==null?void 0:e.message)||"Error al procesar la categoría.";c.add({severity:"error",summary:"Error",detail:m,life:6e3})}},M=l=>{t.value={...l},f.value=!0},B=async()=>{var l,e;try{await _({method:"POST",url:`/api/categorias-hoteles/${t.value.id}`,data:{_method:"DELETE"}}),await D(),f.value=!1,c.add({severity:"success",summary:"¡Eliminada!",detail:"La categoría ha sido eliminada correctamente.",life:5e3})}catch(u){f.value=!1;const m=((e=(l=u.response)==null?void 0:l.data)==null?void 0:e.error)||u.message||"Error desconocido";c.add({severity:"error",summary:"Error",detail:`No se pudo eliminar la categoría: ${m}`,life:6e3})}},H=()=>{x.value?h.value=!0:O()},O=()=>{g.value=!1,h.value=!1,x.value=!1,v.value=null,P()},q=()=>{h.value=!1},G=()=>{t.value.nombre&&t.value.nombre.length>50&&(t.value.nombre=t.value.nombre.substring(0,50))};return(l,e)=>{const u=w("Toast"),m=w("Column"),J=w("DataTable"),K=w("InputText"),N=w("Dialog");return E(),k(ae,null,[o(s(Y),{title:"Control de Categorías de Hoteles"}),o(te,null,{default:n(()=>[o(u,{class:"z-[9999]"}),a("div",ie,[a("div",de,[a("div",ue,[o(s(Z),{href:l.route("hoteles"),class:"flex items-center text-blue-600 hover:text-blue-700 transition-colors duration-200 px-4 rounded-lg",title:"Regresar a Hoteles"},{default:n(()=>[o(s(i),{icon:s(oe),class:"h-8"},null,8,["icon"])]),_:1},8,["href"]),e[6]||(e[6]=a("h3",{class:"text-lg sm:text-2xl text-blue-600 font-bold"},"Control de categorías de hoteles",-1))]),a("button",{class:"bg-blue-500 border border-blue-500 p-2 text-sm text-white shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:F},[o(s(i),{icon:s(le),class:"h-4 w-4 text-white"},null,8,["icon"]),e[7]||(e[7]=a("span",null," Agregar categoría",-1))])]),o(J,{value:S.value,dataKey:"id",paginator:!0,rows:T.value,rowsPerPageOptions:z.value,rowsPerPage:T.value,"onUpdate:rowsPerPage":e[0]||(e[0]=r=>T.value=r),paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} categorías",class:"overflow-x-auto max-w-full",style:{display:"block","max-width":"84vw"},responsiveLayout:"scroll"},{default:n(()=>[o(m,{field:"nombre",header:"Nombre",sortable:"",class:"w-96 min-w-96"},{body:n(r=>[a("div",me,y(r.data.nombre),1)]),_:1}),o(m,{exportable:!1,class:"w-56 min-w-56"},{header:n(()=>e[8]||(e[8]=[a("div",{class:"text-center w-full font-bold"}," Acciones ",-1)])),body:n(r=>[a("div",ce,[a("button",{class:"bg-orange-200/30 border py-2 px-1 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:W=>R(r.data)},[o(s(i),{icon:s(U),class:"h-4 w-4 text-orange-600"},null,8,["icon"]),e[9]||(e[9]=b("  Editar "))],8,ge),a("button",{class:"bg-red-200/30 border py-2 px-1 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:W=>M(r.data)},[o(s(i),{icon:s(re),class:"h-4 w-4 text-red-600"},null,8,["icon"]),e[10]||(e[10]=b("  Eliminar "))],8,ve)])]),_:1})]),_:1},8,["value","rows","rowsPerPageOptions","rowsPerPage"]),o(N,{visible:g.value,"onUpdate:visible":e[2]||(e[2]=r=>g.value=r),header:C.value+" Categoría",modal:!0,style:{width:"450px"},closable:!1},{footer:n(()=>[a("div",ye,[a("button",{type:"button",class:"bg-white hover:bg-green-100 text-green-600 border border-green-600 px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:H},[o(s(i),{icon:s(j),class:"h-5 text-green-600"},null,8,["icon"]),e[12]||(e[12]=b(" Cancelar "))]),a("button",{class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:I},[o(s(i),{icon:s(V),class:"h-5 text-white"},null,8,["icon"]),b(" "+y(C.value),1)])])]),default:n(()=>[a("div",be,[a("div",fe,[a("div",pe,[e[11]||(e[11]=a("label",{for:"nombre",class:"w-24 flex items-center gap-1"},[b(" Nombre: "),a("span",{class:"text-red-500 font-bold"},"*")],-1)),o(K,{modelValue:t.value.nombre,"onUpdate:modelValue":e[1]||(e[1]=r=>t.value.nombre=r),modelModifiers:{trim:!0},id:"nombre",name:"nombre",maxlength:50,class:ee([{"p-invalid":p.value&&(!t.value.nombre||t.value.nombre.length<3||t.value.nombre.length>50)},"flex-1"]),onInput:G,placeholder:"Nombre de la categoría"},null,8,["modelValue","class"])]),t.value.nombre&&t.value.nombre.length<3?(E(),k("small",xe," El nombre debe tener al menos 3 caracteres. Actual: "+y(t.value.nombre.length)+"/3 ",1)):A("",!0),t.value.nombre&&t.value.nombre.length>=45&&t.value.nombre.length<=50?(E(),k("small",he," Caracteres restantes: "+y(50-t.value.nombre.length),1)):A("",!0),p.value&&!t.value.nombre?(E(),k("small",we," El nombre es obligatorio. ")):A("",!0)])])]),_:1},8,["visible","header"]),o(N,{visible:f.value,"onUpdate:visible":e[4]||(e[4]=r=>f.value=r),header:"Eliminar categoría",modal:!0,style:{width:"350px"},closable:!1},{footer:n(()=>[a("div",_e,[a("button",{type:"button",class:"bg-white hover:bg-green-100 text-green-600 border border-green-600 px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:e[3]||(e[3]=r=>f.value=!1)},[o(s(i),{icon:s(j),class:"h-5"},null,8,["icon"]),e[16]||(e[16]=a("span",null,"No",-1))]),a("button",{type:"button",class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:B},[o(s(i),{icon:s(V),class:"h-5"},null,8,["icon"]),e[17]||(e[17]=a("span",null,"Sí",-1))])])]),default:n(()=>[a("div",Ce,[o(s(i),{icon:s($),class:"h-8 w-8 text-red-500"},null,8,["icon"]),a("div",Pe,[a("span",null,[e[13]||(e[13]=b("¿Estás seguro de eliminar la categoría: ")),a("b",null,y(t.value.nombre),1),e[14]||(e[14]=b("?"))]),e[15]||(e[15]=a("span",{class:"text-red-600 text-sm font-medium mt-1"},"Esta acción es irreversible.",-1))])])]),_:1},8,["visible"]),o(N,{visible:h.value,"onUpdate:visible":e[5]||(e[5]=r=>h.value=r),header:"Cambios sin guardar",modal:!0,style:{width:"400px"},closable:!1},{footer:n(()=>[a("div",Ee,[a("button",{type:"button",class:"bg-white hover:bg-green-100 text-green-600 border border-green-600 px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:q},[o(s(i),{icon:s(U),class:"h-4"},null,8,["icon"]),e[19]||(e[19]=a("span",null,"Continuar",-1))]),a("button",{type:"button",class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:O},[o(s(i),{icon:s(ne),class:"h-4"},null,8,["icon"]),e[20]||(e[20]=a("span",null,"Salir sin guardar",-1))])])]),default:n(()=>[a("div",ke,[o(s(i),{icon:s($),class:"h-8 w-8 text-red-500"},null,8,["icon"]),e[18]||(e[18]=a("div",{class:"flex flex-col"},[a("span",null,"¡Tienes información sin guardar!"),a("span",{class:"text-red-600 text-sm font-medium mt-1"},"¿Deseas salir sin guardar?")],-1))])]),_:1},8,["visible"])])]),_:1})],64)}}};export{Ue as default};
