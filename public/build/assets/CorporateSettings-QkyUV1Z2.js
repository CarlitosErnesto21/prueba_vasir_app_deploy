import{r as p,E as P,b as H,w as O,n as j,c as m,d as g,a2 as ce,e as s,p as T,q as x,v as y,a5 as h,j as _,F as pe,l as ge,y as K,t as z,$ as w,h as me,a3 as ve}from"./vendor-BOi6Gr0G.js";import{z as be,A as M,a as fe}from"./ui-BibPgP1I.js";import{b as xe,u as ye,q as he}from"./index-Btbp3Gjs.js";import Q from"./UnsavedChangesModal-DD-4TYnm.js";const we={class:"bg-white rounded-lg shadow-lg overflow-hidden"},Ve={class:"p-3 sm:p-4 lg:p-5"},Ce={class:"space-y-4"},Ee={class:"bg-gray-50 rounded-lg p-3 sm:p-4 border border-gray-200"},Se={class:"mb-4"},Ne={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},ke={class:"bg-purple-50 rounded-lg p-3 sm:p-4 border border-purple-200"},De={class:"flex items-center justify-between mb-3"},Oe={key:0,class:"bg-white rounded-lg p-3 mb-3 border border-purple-300"},Te={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},_e={class:"flex gap-2 mt-3"},qe=["disabled"],Je={class:"max-h-48 overflow-y-auto"},Ae={key:0,class:"flex items-start justify-between"},Ie={class:"flex-1 mr-3"},$e={class:"flex items-center gap-2"},je={class:"text-sm font-semibold text-gray-800"},ze={key:0,class:"px-2 py-1 text-xs bg-green-100 text-green-700 rounded"},Me={key:1,class:"px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded"},Ue={class:"text-xs text-gray-600 mt-1 line-clamp-2"},Re={class:"flex gap-1 flex-shrink-0"},Fe=["onClick"],Be=["onClick"],We={key:1,class:"space-y-2"},Ge=["disabled"],Le={key:0,class:"text-center py-6"},Pe={class:"flex flex-col sm:flex-row sm:justify-end gap-2 mt-4 pt-3 border-t border-gray-200"},He=["disabled"],Ke=["disabled"],et={__name:"CorporateSettings",props:{settings:{type:Object,required:!0},companyValues:{type:Array,default:()=>[]},isSaving:{type:Boolean,default:!1}},emits:["save","reset","unsaved-changes","settings-updated"],setup(C,{emit:X}){const V=C,U=X,R=be(),c=p(!1),d=p({}),q=p({}),E=p(!1),F=i=>{if(!i)return;const t={description:i.description||"",mission:i.mission||"",vision:i.vision||"",...i};q.value=JSON.parse(JSON.stringify(t)),d.value=JSON.parse(JSON.stringify(t)),c.value=!1,E.value=!0},Y=P(()=>c.value),Z=P(()=>c.value),b=p(!1),f=p(null),S=p(!1),N=p(!1),k=p(null),r=H({titulo:"",descripcion:""}),l=H({titulo:"",descripcion:""}),J=p([]),o=p([]),A=()=>{J.value=JSON.parse(JSON.stringify(V.companyValues)),o.value=JSON.parse(JSON.stringify(V.companyValues))},ee=()=>{const i=JSON.stringify(J.value),t=JSON.stringify(o.value);return i!==t},D=()=>{const i=JSON.stringify(d.value)!==JSON.stringify(q.value),t=ee(),e=b.value&&(r.titulo||r.descripcion),a=f.value!==null;c.value=i||t||e||a};O([d,o,b,r,f],()=>{E.value&&j(()=>{D()})},{deep:!0,flush:"post"}),O(()=>V.companyValues,i=>{c.value||A()},{immediate:!0,deep:!0}),O(()=>V.settings,i=>{c.value||(E.value=!1,F(i))},{immediate:!0,deep:!0}),O(c,i=>{U("unsaved-changes",i)});const te=async()=>{try{const i=c.value;c.value=!1;const t={description:d.value.description,mission:d.value.mission,vision:d.value.vision,companyValues:{new:o.value.filter(e=>e.isNew&&!e.isDeleted).map(e=>({titulo:e.titulo,descripcion:e.descripcion})),updated:o.value.filter(e=>e.isModified&&!e.isDeleted&&!e.isNew).map(e=>({id:e.id,titulo:e.titulo,descripcion:e.descripcion})),deleted:J.value.filter(e=>o.value.find(a=>a.id===e.id&&a.isDeleted)).map(e=>e.id)}};ve.post(route("settings.update"),t,{onSuccess:()=>{q.value=JSON.parse(JSON.stringify(d.value));const e=o.value.filter(a=>!a.isDeleted).map(a=>({id:a.id,titulo:a.titulo,descripcion:a.descripcion}));o.value=e,J.value=JSON.parse(JSON.stringify(e)),I(),$(),U("settings-updated"),j(()=>{D()})},onError:e=>{c.value=i,console.error("Error al guardar configuraciÃ³n corporativa:",e);const a=u=>{const n={"The mission field is required.":"El campo de misiÃ³n es obligatorio.","The vision field is required.":"El campo de visiÃ³n es obligatorio.","The description field is required.":"El campo de descripciÃ³n es obligatorio.","The title field is required.":"El campo de tÃ­tulo es obligatorio.",required:"es obligatorio","field is required":"es obligatorio"};return n[u]?n[u]:u.includes("field is required")?u.replace("field is required","es obligatorio").replace("The ","El campo "):u};let v="Error al guardar la configuraciÃ³n corporativa.";if(e&&typeof e=="object"){const u=[];if(e.mission){const n=Array.isArray(e.mission)?e.mission[0]:e.mission;u.push("â€¢ MisiÃ³n: "+a(n))}if(e.vision){const n=Array.isArray(e.vision)?e.vision[0]:e.vision;u.push("â€¢ VisiÃ³n: "+a(n))}if(e.description){const n=Array.isArray(e.description)?e.description[0]:e.description;u.push("â€¢ DescripciÃ³n: "+a(n))}Object.keys(e).forEach(n=>{if(n.startsWith("company_values.")){const W=n.split(".")[1],G=n.split(".")[2],L=Array.isArray(e[n])?e[n][0]:e[n];G==="title"?u.push(`â€¢ Valor corporativo ${parseInt(W)+1} - TÃ­tulo: ${a(L)}`):G==="description"&&u.push(`â€¢ Valor corporativo ${parseInt(W)+1} - DescripciÃ³n: ${a(L)}`)}}),u.length>0&&(v=`Por favor corrija los siguientes errores:

`+u.join(`
`))}R.add({severity:"error",summary:"Error de ValidaciÃ³n",detail:v,life:6e3})}})}catch(i){console.error("Error al guardar configuraciÃ³n corporativa:",i),R.add({severity:"error",summary:"Error Interno",detail:"OcurriÃ³ un error inesperado al guardar la configuraciÃ³n. Por favor, intÃ©ntalo de nuevo.",life:5e3})}},se=()=>{c.value?S.value=!0:B()},B=()=>{E.value=!1,d.value=JSON.parse(JSON.stringify(q.value)),c.value=!1,A(),I(),$(),E.value=!0},ie=()=>{S.value=!1,B()},oe=()=>{S.value=!1},re=()=>{if(!r.titulo||!r.descripcion)return;const i={id:`temp_${Date.now()}`,titulo:r.titulo,descripcion:r.descripcion,isNew:!0};o.value.push(i),r.titulo="",r.descripcion="",b.value=!1,D()},I=()=>{r.titulo="",r.descripcion="",b.value=!1},ae=i=>{f.value=i.id,l.titulo=i.titulo,l.descripcion=i.descripcion,j(()=>{setTimeout(()=>{const t=document.querySelector(`.value-container-${i.id}`);t&&t.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},100)})},le=()=>{if(!l.titulo||!l.descripcion)return;const i=o.value.findIndex(t=>t.id===f.value);i!==-1&&(o.value[i].titulo=l.titulo,o.value[i].descripcion=l.descripcion,o.value[i].isNew||(o.value[i].isModified=!0)),f.value=null,l.titulo="",l.descripcion="",D()},$=()=>{f.value=null,l.titulo="",l.descripcion=""},ne=i=>{k.value=i,N.value=!0},de=()=>{if(!k.value)return;const i=o.value.findIndex(t=>t.id===k.value);i!==-1&&(o.value[i].isNew?o.value.splice(i,1):o.value[i].isDeleted=!0),D(),N.value=!1,k.value=null},ue=()=>{N.value=!1,k.value=null};return O([()=>V.settings,()=>V.companyValues],([i,t])=>{i&&F(i),t&&A()},{deep:!0}),A(),(i,t)=>(g(),m("div",we,[t[19]||(t[19]=ce('<div class="bg-gradient-to-r from-blue-600 to-blue-700 px-2 sm:px-4 lg:px-6 py-2 sm:py-3 lg:py-4"><h1 class="text-sm sm:text-lg lg:text-2xl font-bold text-white flex items-center"><span class="text-sm sm:text-lg lg:text-2xl mr-1 sm:mr-2 lg:mr-3">ğŸ¢</span><span class="hidden sm:inline">InformaciÃ³n Corporativa</span><span class="sm:hidden">Info Corporativa</span></h1><p class="text-blue-100 mt-0.5 sm:mt-1 lg:mt-2 text-xs sm:text-sm lg:text-base hidden sm:block">Configure el contenido que aparece en la pÃ¡gina &quot;Sobre Nosotros&quot;</p></div>',1)),s("div",Ve,[s("div",Ce,[s("div",Ee,[t[13]||(t[13]=s("h3",{class:"text-sm sm:text-base font-semibold text-gray-800 mb-3 flex items-center"},[s("span",{class:"text-base sm:text-lg mr-2"},"ğŸ“"),x(" InformaciÃ³n BÃ¡sica ")],-1)),s("div",Se,[t[10]||(t[10]=s("label",{class:"block text-xs sm:text-sm font-medium text-gray-700 mb-2"}," DescripciÃ³n de la Empresa ",-1)),y(s("textarea",{"onUpdate:modelValue":t[0]||(t[0]=e=>d.value.description=e),rows:"4",class:"w-full px-3 py-3 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent resize-none shadow-sm",placeholder:"Describe brevemente quÃ© es VASIR, su propÃ³sito y lo que ofrece a los clientes..."},null,512),[[h,d.value.description]])]),s("div",Ne,[s("div",null,[t[11]||(t[11]=s("label",{class:"flex items-center text-xs sm:text-sm font-medium text-gray-700 mb-2"},[s("span",{class:"text-sm mr-1"},"ğŸ¯"),x(" MisiÃ³n Corporativa ")],-1)),y(s("textarea",{"onUpdate:modelValue":t[1]||(t[1]=e=>d.value.mission=e),rows:"4",class:"w-full px-3 py-3 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent resize-none shadow-sm",placeholder:"Nuestra misiÃ³n es..."},null,512),[[h,d.value.mission]])]),s("div",null,[t[12]||(t[12]=s("label",{class:"flex items-center text-xs sm:text-sm font-medium text-gray-700 mb-2"},[s("span",{class:"text-sm mr-1"},"ğŸŒŸ"),x(" VisiÃ³n Corporativa ")],-1)),y(s("textarea",{"onUpdate:modelValue":t[2]||(t[2]=e=>d.value.vision=e),rows:"4",class:"w-full px-3 py-3 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent resize-none shadow-sm",placeholder:"Nuestra visiÃ³n es..."},null,512),[[h,d.value.vision]])])])]),s("div",ke,[s("div",De,[t[15]||(t[15]=s("h3",{class:"text-sm sm:text-base font-semibold text-gray-800 flex items-center"},[s("span",{class:"text-base sm:text-lg mr-2"},"ğŸ’"),x(" Valores Corporativos ")],-1)),s("button",{onClick:t[3]||(t[3]=e=>b.value=!b.value),type:"button",class:"px-3 py-1.5 text-xs sm:text-sm bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors duration-200 flex items-center"},t[14]||(t[14]=[s("span",{class:"mr-1"},"+",-1),s("span",{class:"hidden sm:inline"},"Agregar",-1),s("span",{class:"sm:hidden"},"+",-1)]))]),b.value?(g(),m("div",Oe,[s("div",Te,[s("div",null,[y(s("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>r.titulo=e),type:"text",maxlength:"100",class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"TÃ­tulo del valor (ej: Integridad)"},null,512),[[h,r.titulo]])]),s("div",null,[y(s("textarea",{"onUpdate:modelValue":t[5]||(t[5]=e=>r.descripcion=e),rows:"1",maxlength:"500",class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none",placeholder:"DescripciÃ³n del valor..."},null,512),[[h,r.descripcion]])])]),s("div",_e,[s("button",{onClick:re,disabled:!r.titulo||!r.descripcion,type:"button",class:"px-3 py-1.5 text-sm bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-400 transition-colors duration-200 flex items-center"}," Agregar ",8,qe),s("button",{onClick:I,type:"button",class:"px-3 py-1.5 text-sm border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors duration-200"}," Cancelar ")])])):_("",!0),s("div",Je,[(g(!0),m(pe,null,ge(o.value.filter(e=>!e.isDeleted),(e,a)=>(g(),m("div",{key:e.id,class:K([`value-container-${e.id}`,"bg-white rounded-lg p-3 mb-2 border border-gray-200 hover:border-purple-300 transition-colors duration-200",{"border-green-300 bg-green-50":e.isNew,"border-blue-300 bg-blue-50":e.isModified}])},[f.value!==e.id?(g(),m("div",Ae,[s("div",Ie,[s("div",$e,[s("h5",je,z(e.titulo),1),e.isNew?(g(),m("span",ze,"Nuevo")):_("",!0),e.isModified?(g(),m("span",Me,"Modificado")):_("",!0)]),s("p",Ue,z(e.descripcion),1)]),s("div",Re,[s("button",{onClick:v=>ae(e),type:"button",class:"px-3 py-2 text-sm bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors duration-200 flex items-center hover:shadow",title:"Editar valor"},[T(w(M),{icon:w(xe),class:"mr-1"},null,8,["icon"]),t[16]||(t[16]=x(" Editar "))],8,Fe),s("button",{onClick:v=>ne(e.id),type:"button",class:"px-3 py-2 text-sm bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors duration-200 flex items-center hover:shadow",title:"Eliminar valor"},[T(w(M),{icon:w(ye),class:"mr-1"},null,8,["icon"]),t[17]||(t[17]=x(" Eliminar "))],8,Be)])])):(g(),m("div",We,[y(s("input",{"onUpdate:modelValue":t[6]||(t[6]=v=>l.titulo=v),type:"text",maxlength:"100",class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"TÃ­tulo"},null,512),[[h,l.titulo]]),y(s("textarea",{"onUpdate:modelValue":t[7]||(t[7]=v=>l.descripcion=v),rows:"2",maxlength:"500",class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"DescripciÃ³n"},null,512),[[h,l.descripcion]]),s("div",{class:K(["flex gap-2",`edit-buttons-${e.id}`])},[s("button",{onClick:le,disabled:!l.titulo||!l.descripcion,type:"button",class:"px-3 py-1.5 text-sm bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-400 transition-colors duration-200 flex items-center"}," Guardar ",8,Ge),s("button",{onClick:$,type:"button",class:"px-3 py-1.5 text-sm border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors duration-200"}," Cancelar ")],2)]))],2))),128)),o.value.filter(e=>!e.isDeleted).length===0?(g(),m("div",Le,t[18]||(t[18]=[s("span",{class:"text-3xl mb-2 block"},"ğŸ’",-1),s("p",{class:"text-sm text-gray-500"},"No hay valores corporativos",-1),s("p",{class:"text-xs text-gray-400 mt-1"},"Agrega el primer valor",-1)]))):_("",!0)])])]),s("div",Pe,[s("button",{onClick:se,disabled:!Z.value||C.isSaving,type:"button",class:"px-4 py-2 text-sm border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 disabled:bg-gray-100 disabled:text-gray-400 disabled:cursor-not-allowed transition-colors duration-200"}," Restablecer ",8,He),s("button",{onClick:te,disabled:!Y.value||C.isSaving,type:"button",class:"px-4 py-2 text-sm bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors duration-200 flex items-center justify-center"},[C.isSaving?(g(),me(w(M),{key:0,icon:w(he),class:"animate-spin mr-2"},null,8,["icon"])):_("",!0),x(" "+z(C.isSaving?"Guardando...":"Guardar ConfiguraciÃ³n"),1)],8,Ke)])]),T(Q,{visible:S.value,"onUpdate:visible":t[8]||(t[8]=e=>S.value=e),title:"Â¿Restablecer todos los cambios?",message:"Esta acciÃ³n restablecerÃ¡ todos los campos a sus valores originales.",subtitle:"Los cambios no guardados se perderÃ¡n.",continueText:"Cancelar",exitText:"Restablecer",onContinueEditing:oe,onExitWithoutSaving:ie},null,8,["visible"]),T(Q,{visible:N.value,"onUpdate:visible":t[9]||(t[9]=e=>N.value=e),title:"Â¿Eliminar valor corporativo?",message:"Â¿EstÃ¡s seguro de que deseas eliminar este valor corporativo?",subtitle:"Esta acciÃ³n no se puede deshacer una vez que guardes los cambios.",continueText:"Cancelar",exitText:"Eliminar",onContinueEditing:ue,onExitWithoutSaving:de},null,8,["visible"]),T(w(fe))]))}};export{et as default};
