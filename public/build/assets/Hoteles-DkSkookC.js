import{r as d,o as ce,N as y,k as A,c as v,d as p,p as s,$ as i,a0 as ve,x as r,e as l,a1 as B,q as b,t as h,j as w,y as k,v as O,a5 as R,F as W,l as pe}from"./vendor-BOi6Gr0G.js";import{A as me}from"./AuthenticatedLayout-ySbiGZ3w.js";import{z as fe,F as ge,a as be,A as V,n as S,k as xe,o as ye}from"./ui-BibPgP1I.js";import{k as he,l as we,a as _e,m as Ce,n as ke,c as Ve}from"./index-Btbp3Gjs.js";import"./logo-DN1bLr27.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Ie={class:"py-6 px-7 mt-10 mx-auto bg-red-100 shadow-md rounded-lg"},De={class:"flex flex-col lg:flex-row lg:justify-between lg:items-center mb-4 gap-4"},Ee={class:"flex flex-col sm:flex-row items-center gap-4 w-full lg:w-auto lg:justify-end"},Ne={class:"flex gap-2"},Ae=["onClick"],Ue=["onClick"],He=["onClick"],Te={class:"space-y-4"},$e={class:"w-full flex flex-col"},Fe={class:"flex items-center gap-4"},Se={key:0,class:"text-red-500 ml-28"},Le={class:"w-full flex flex-col"},Pe={class:"flex items-center gap-4"},je={key:0,class:"text-red-500 ml-28"},ze={class:"w-full flex flex-col"},Me={class:"flex items-center gap-4"},Ge={key:0,class:"text-red-500 ml-28"},Be={class:"w-full flex flex-col"},Oe={class:"flex items-center gap-4"},Re={key:0,class:"text-red-500 ml-28"},We={class:"w-full flex flex-col"},qe={class:"flex items-center gap-4"},Ke={key:0,class:"text-red-500 ml-28"},Ze={class:"w-full flex flex-col"},Je={class:"flex items-center gap-4"},Qe={key:0,class:"text-red-500 ml-28"},Xe={class:"w-full flex flex-col"},Ye={class:"flex items-center gap-4"},ea={key:0,class:"text-red-500 ml-28"},aa={class:"flex gap-4 flex-wrap mt-4 ml-28"},la=["src"],oa=["onClick"],ta={class:"flex justify-center gap-4 w-full"},sa=["label"],ia={class:"flex items-center gap-3"},ra={key:0,class:"flex flex-col items-center justify-center"},na={class:"flex justify-center items-center w-full h-96"},da=["src"],ua={key:1,class:"text-center text-gray-500 py-8"},ca={class:"flex justify-center w-full"},U="/api/hoteles",q="/storage/hoteles/",ya={__name:"Hoteles",setup(va){const f=fe(),L=d([]),t=d({id:null,nombre:"",direccion:"",descripcion:"",estado:"",provincia:null,categoria:null,imagenes:[]}),m=d([]),x=d([]),_=d([]),P=d(),C=d(!1),I=d(!1),n=d(!1),H=d({global:{value:null,matchMode:ge.CONTAINS}}),E=d("Guardar"),K=d([]),j=d([]),z=d([]),M=d([{label:"Activo",value:"activo"},{label:"Inactivo",value:"inactivo"}]),N=d(!1),D=d([]);ce(()=>{T(),Z(),J(),Q()});const T=async()=>{try{const a=await y.get(U);L.value=a.data.map(e=>({...e,imagenes:(e.imagenes||[]).map(u=>typeof u=="string"?u:u.nombre)}))}catch{f.add({severity:"error",summary:"Error",detail:"No se pudieron cargar los hoteles",life:4e3})}},Z=async()=>{try{const a=await y.get("/api/paises");K.value=a.data}catch{f.add({severity:"error",summary:"Error",detail:"No se pudieron cargar los países",life:4e3})}},J=async()=>{try{const a=await y.get("/api/provincias");j.value=a.data}catch{f.add({severity:"error",summary:"Error",detail:"No se pudieron cargar las provincias",life:4e3})}},Q=async()=>{try{const a=await y.get("/api/categorias-hoteles");z.value=a.data}catch{f.add({severity:"error",summary:"Error",detail:"No se pudieron cargar las categorías",life:4e3})}},X=()=>{t.value={id:null,nombre:"",direccion:"",descripcion:"",estado:"",provincia:null,categoria:null,imagenes:[]},m.value=[],x.value=[],_.value=[],n.value=!1,E.value="Guardar",C.value=!0},Y=a=>{t.value={...a},t.value.categoria=a.categoria_hotel?a.categoria_hotel.id:null,t.value.provincia=a.provincia?a.provincia.id:null,m.value=Array.isArray(a.imagenes)?a.imagenes.map(e=>typeof e=="string"?e:e.nombre):[],x.value=[],_.value=[],E.value="Actualizar",C.value=!0},ee=async()=>{if(n.value=!0,!(!t.value.nombre||!t.value.direccion||!t.value.descripcion||!t.value.estado||!t.value.provincia||!t.value.categoria)){if(m.value.length===0){f.add({severity:"error",summary:"Error",detail:"Debes subir al menos una imagen.",life:4e3});return}try{const a=new FormData;a.append("nombre",t.value.nombre),a.append("direccion",t.value.direccion),a.append("descripcion",t.value.descripcion),a.append("estado",t.value.estado),a.append("provincia_id",t.value.provincia),a.append("categoria_id",t.value.categoria),x.value.forEach(u=>{u instanceof File&&a.append("imagenes[]",u)}),_.value.forEach(u=>{a.append("removed_images[]",u.split("/").pop())});let e;t.value.id?(a.append("_method","PUT"),e=await y.post(`${U}/${t.value.id}`,a,{headers:{"Content-Type":"multipart/form-data"}}),f.add({severity:"info",summary:"Hotel actualizado",life:3e3})):(e=await y.post(U,a,{headers:{"Content-Type":"multipart/form-data"}}),f.add({severity:"success",summary:"Hotel agregado",life:3e3})),await T(),C.value=!1,t.value={id:null,nombre:"",direccion:"",descripcion:"",estado:"",provincia:null,categoria:null,imagenes:[]},m.value=[],x.value=[],_.value=[],n.value=!1}catch{f.add({severity:"error",summary:"Error",detail:"No se pudo guardar el hotel.",life:4e3})}}},ae=a=>{t.value={...a},I.value=!0},le=async()=>{try{await y.delete(`${U}/${t.value.id}`),T(),I.value=!1,f.add({severity:"warn",summary:"Hotel eliminado",life:3e3})}catch{f.add({severity:"error",summary:"Error",detail:"No se pudo eliminar el hotel.",life:4e3})}},oe=()=>{C.value=!1,m.value=[],x.value=[],_.value=[],n.value=!1},te=a=>{for(const e of a.files)if(e instanceof File){x.value.push(e);const u=new FileReader;u.onload=g=>{m.value.push(g.target.result)},u.readAsDataURL(e)}},se=a=>{const e=m.value[a];typeof e=="string"&&e.startsWith("data:image")?(m.value.splice(a,1),x.value.splice(a,1)):(_.value.push(e),m.value.splice(a,1))};function ie(a){const e=M.value.find(u=>u.value===a);return e?e.label:""}function G(a){return a.replace(/^\s+/,"").replace(/[^A-Za-zÁÉÍÓÚáéíóúÑñÜü\s]/g,"")}function re(a,e){typeof e=="string"&&(t.value[a]=G(e))}function ne(a,e){e&&e.value&&(e.value=G(e.value))}const de=a=>{D.value=(a||[]).map(e=>q+(typeof e=="string"?e:e.nombre)),N.value=!0};return(a,e)=>{const u=A("InputText"),g=A("Column"),ue=A("DataTable"),$=A("Dialog");return p(),v(W,null,[s(i(ve),{title:"Hoteles"}),s(me,null,{default:r(()=>[s(i(be)),l("div",Ie,[l("div",De,[e[19]||(e[19]=l("h3",{class:"text-xl font-bold"},"Catálogo hoteles",-1)),l("div",Ee,[s(i(B),{href:a.route("controlPaisesProvincias"),class:"bg-blue-500 border border-blue-500 p-2 text-sm text-white shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300"},{default:r(()=>[s(i(V),{icon:i(he),class:"h-4"},null,8,["icon"]),e[16]||(e[16]=l("span",{class:"ml-2 whitespace-nowrap"},"Control paises",-1))]),_:1,__:[16]},8,["href"]),s(i(B),{href:a.route("catHoteles"),class:"bg-blue-500 border border-blue-500 p-2 text-sm text-white shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300"},{default:r(()=>[s(i(V),{icon:i(we),class:"h-4"},null,8,["icon"]),e[17]||(e[17]=l("span",{class:"ml-2 whitespace-nowrap"},"Gestionar categorías",-1))]),_:1,__:[17]},8,["href"]),l("button",{class:"bg-red-500 border border-red-500 p-2 text-sm text-white shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:X},[s(i(V),{icon:i(_e),class:"h-4 w-4 text-white"},null,8,["icon"]),e[18]||(e[18]=l("span",null," Agregar hotel",-1))])])]),s(ue,{value:L.value,selection:P.value,"onUpdate:selection":e[1]||(e[1]=o=>P.value=o),dataKey:"id",filters:H.value,paginator:!0,rows:10,class:"overflow-x-auto max-w-full",style:{display:"block","max-width":"84vw"}},{header:r(()=>[s(u,{modelValue:H.value.global.value,"onUpdate:modelValue":e[0]||(e[0]=o=>H.value.global.value=o),placeholder:"Buscar...",class:"w-full"},null,8,["modelValue"])]),default:r(()=>[s(g,{field:"nombre",header:"Nombre",sortable:""}),s(g,{field:"direccion",header:"Dirección"},{body:r(o=>[b(h(o.data.direccion),1)]),_:1}),s(g,{field:"descripcion",header:"Descripción"},{body:r(o=>[b(h(o.data.descripcion||""),1)]),_:1}),s(g,{field:"estado",header:"Estado"},{body:r(o=>[b(h(ie(o.data.estado)),1)]),_:1}),s(g,{header:"Categoría"},{body:r(o=>{var c;return[b(h(((c=o.data.categoria_hotel)==null?void 0:c.nombre)||""),1)]}),_:1}),s(g,{field:"pais",header:"País"},{body:r(o=>{var c,F;return[b(h(((F=(c=o.data.provincia)==null?void 0:c.pais)==null?void 0:F.nombre)||""),1)]}),_:1}),s(g,{header:"Provincia"},{body:r(o=>{var c;return[b(h(((c=o.data.provincia)==null?void 0:c.nombre)||""),1)]}),_:1}),s(g,{header:"Acciones",exportable:!1},{body:r(o=>[l("div",Ne,[l("button",{class:"text-orange-600 hover:text-orange-900 transition-colors",onClick:c=>Y(o.data),title:"Editar"},[s(i(V),{icon:i(Ce),class:"h-5 w-5"},null,8,["icon"])],8,Ae),l("button",{class:"text-blue-600 hover:text-blue-900 transition-colors",onClick:c=>de(o.data.imagenes)},[s(i(V),{icon:i(ke),class:"h-5 w-5"},null,8,["icon"])],8,Ue),l("button",{class:"text-red-600 hover:text-red-900 transition-colors",onClick:c=>ae(o.data),title:"Eliminar"},[s(i(V),{icon:i(Ve),class:"h-5 w-5"},null,8,["icon"])],8,He)])]),_:1})]),_:1},8,["value","selection","filters"]),s($,{visible:C.value,"onUpdate:visible":e[10]||(e[10]=o=>C.value=o),header:E.value+" Hotel",modal:!0,style:{width:"500px"}},{footer:r(()=>[l("div",ta,[l("button",{onClick:oe,class:"flex items-center border border-green-600 text-green-600 hover:bg-green-50 disabled:border-gray-400 disabled:text-gray-400 font-semibold py-2 px-6 rounded-lg transition-colors duration-200"},e[28]||(e[28]=[l("i",{class:"pi pi-times mr-2"},null,-1),b(" Cancelar ")])),l("button",{label:E.value,onClick:ee,class:"bg-red-600 text-white hover:bg-red-700 disabled:bg-gray-400 disabled:text-gray-200 font-semibold py-2 px-6 rounded-lg transition-colors duration-200"},e[29]||(e[29]=[l("i",{class:"pi pi-check mr-2"},null,-1),b(" Guardar ")]),8,sa)])]),default:r(()=>[l("div",Te,[l("div",$e,[l("div",Fe,[e[20]||(e[20]=l("label",{for:"nombre",class:"w-24"},"Nombre:",-1)),s(u,{modelValue:t.value.nombre,"onUpdate:modelValue":e[2]||(e[2]=o=>t.value.nombre=o),modelModifiers:{trim:!0},id:"nombre",class:k([{"p-invalid":n.value&&!t.value.nombre},"flex-1"])},null,8,["modelValue","class"])]),n.value&&!t.value.nombre?(p(),v("small",Se,"El nombre es obligatorio.")):w("",!0)]),l("div",Le,[l("div",Pe,[e[21]||(e[21]=l("label",{for:"direccion",class:"w-24"},"Dirección:",-1)),O(l("textarea",{"onUpdate:modelValue":e[3]||(e[3]=o=>t.value.direccion=o),id:"direccion",class:k([{"p-invalid":n.value&&!t.value.direccion},"flex-1"])},null,2),[[R,t.value.direccion,void 0,{trim:!0}]])]),n.value&&!t.value.direccion?(p(),v("small",je,"La dirección es obligatoria.")):w("",!0)]),l("div",ze,[l("div",Me,[e[22]||(e[22]=l("label",{for:"descripcion",class:"w-24"},"Descripción:",-1)),O(l("textarea",{"onUpdate:modelValue":e[4]||(e[4]=o=>t.value.descripcion=o),id:"descripcion",class:k([{"p-invalid":n.value&&!t.value.descripcion},"flex-1"])},null,2),[[R,t.value.descripcion,void 0,{trim:!0}]])]),n.value&&!t.value.descripcion?(p(),v("small",Ge,"La descripción es obligatoria.")):w("",!0)]),l("div",Be,[l("div",Oe,[e[23]||(e[23]=l("label",{for:"estado",class:"w-24"},"Estado:",-1)),s(i(S),{modelValue:t.value.estado,"onUpdate:modelValue":e[5]||(e[5]=o=>t.value.estado=o),options:M.value,"option-label":"label","option-value":"value",id:"estado",class:k(["flex-1",{"p-invalid":n.value&&!t.value.estado}]),placeholder:"Selecciona un estado"},null,8,["modelValue","options","class"])]),n.value&&!t.value.estado?(p(),v("small",Re,"El estado es obligatorio.")):w("",!0)]),l("div",We,[l("div",qe,[e[24]||(e[24]=l("label",{for:"categoria",class:"w-24"},"Categoría:",-1)),s(i(S),{modelValue:t.value.categoria,"onUpdate:modelValue":e[6]||(e[6]=o=>t.value.categoria=o),options:z.value,"option-label":"nombre","option-value":"id",id:"categoria",class:k(["flex-1",{"p-invalid":n.value&&!t.value.categoria}]),placeholder:"Selecciona una categoría"},null,8,["modelValue","options","class"])]),n.value&&!t.value.categoria?(p(),v("small",Ke,"La categoría es obligatoria.")):w("",!0)]),l("div",Ze,[l("div",Je,[e[25]||(e[25]=l("label",{for:"provincia",class:"w-24"},"Provincia:",-1)),s(i(S),{modelValue:t.value.provincia,"onUpdate:modelValue":e[7]||(e[7]=o=>t.value.provincia=o),options:j.value,"option-label":"nombre","option-value":"id",id:"provincia",filter:!0,filterPlaceholder:"Buscar provincia...",showClear:!0,class:k([{"p-invalid":n.value&&!t.value.provincia},"flex-1"]),placeholder:"Selecciona una provincia",onInput:e[8]||(e[8]=o=>re("provincia",o)),onFilter:e[9]||(e[9]=o=>ne("provincia",o))},null,8,["modelValue","options","class"])]),n.value&&!t.value.provincia?(p(),v("small",Qe,"La provincia es obligatoria.")):w("",!0)]),l("div",Xe,[l("div",Ye,[e[26]||(e[26]=l("label",{for:"imagen",class:"w-24"},"Imágenes:",-1)),s(i(xe),{mode:"basic",name:"imagenes[]",accept:"image/*",auto:!0,chooseLabel:"Seleccionar imágenes",onSelect:te,customUpload:!0,multiple:!0,class:"flex-1 p-button-rounded p-button-warn p-button-md mr-2"})]),n.value&&m.value.length===0?(p(),v("small",ea,"Al menos una imagen es obligatoria.")):w("",!0)]),l("div",aa,[(p(!0),v(W,null,pe(m.value,(o,c)=>(p(),v("div",{key:c,class:"relative w-32 h-32"},[l("img",{src:o.startsWith("data:image")?o:q+o,alt:"Vista previa",class:"w-full h-full object-cover rounded border"},null,8,la),l("button",{onClick:F=>se(c),class:"absolute top-0 right-0 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 shadow",style:{transform:"translate(50%, -50%)"}},e[27]||(e[27]=[l("i",{class:"pi pi-times text-xs"},null,-1)]),8,oa)]))),128))])])]),_:1},8,["visible","header"]),s($,{visible:I.value,"onUpdate:visible":e[12]||(e[12]=o=>I.value=o),header:"Confirmar",modal:!0,style:{width:"350px"}},{footer:r(()=>[l("button",{onClick:e[11]||(e[11]=o=>I.value=!1),class:"border border-green-600 text-green-600 hover:bg-green-50 disabled:border-gray-400 disabled:text-gray-400 font-semibold py-2 px-6 rounded-lg transition-colors duration-200"}," No "),l("button",{onClick:le,class:"bg-red-600 text-white hover:bg-red-700 disabled:bg-gray-400 disabled:text-gray-200 font-semibold py-2 px-6 rounded-lg transition-colors duration-200"}," Sí ")]),default:r(()=>[l("div",ia,[e[32]||(e[32]=l("i",{class:"pi pi-exclamation-triangle text-black-500",style:{"font-size":"1.50rem"}},null,-1)),l("span",null,[e[30]||(e[30]=b("¿Eliminar el hotel ")),l("b",null,h(t.value.nombre),1),e[31]||(e[31]=b("?"))])])]),_:1},8,["visible"]),s($,{visible:N.value,"onUpdate:visible":e[15]||(e[15]=o=>N.value=o),header:"Imágenes del hotel",modal:!0,style:{width:"700px"}},{footer:r(()=>[l("div",ca,[l("button",{onClick:e[14]||(e[14]=o=>N.value=!1),class:"border border-green-600 text-green-600 hover:bg-green-50 disabled:border-gray-400 disabled:text-gray-400 font-semibold py-2 px-6 rounded-lg transition-colors duration-200"}," Cerrar ")])]),default:r(()=>[D.value.length?(p(),v("div",ra,[s(i(ye),{value:D.value,numVisible:1,numScroll:1,circular:!0,page:a.carouselIndex,"onUpdate:page":e[13]||(e[13]=o=>a.carouselIndex=o),class:"w-full",showIndicators:D.value.length>1,showNavigators:D.value.length>1,style:{"max-width":"610px"}},{item:r(o=>[l("div",na,[l("img",{src:o.data,alt:"Imagen hotel",class:"w-auto h-full max-h-96 object-contain rounded shadow"},null,8,da)])]),_:1},8,["value","page","showIndicators","showNavigators"])])):(p(),v("div",ua," No hay imágenes para este hotel. "))]),_:1},8,["visible"])])]),_:1})],64)}}};export{ya as default};
