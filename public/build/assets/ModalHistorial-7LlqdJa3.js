import{E as j,k as B,h as M,d as a,x as h,c as r,j as n,e,t as i,y as u,F as N,l as F,q as d}from"./vendor-BOi6Gr0G.js";const P={key:0,class:"p-6"},S={class:"bg-gray-50 rounded-lg p-4 mb-6"},H={class:"flex justify-between items-start"},T={class:"font-medium text-gray-900 mb-2"},A={class:"grid grid-cols-2 gap-4 text-sm"},U={class:"block text-gray-900"},V={class:"block text-gray-900"},I={class:"block text-gray-900 font-medium"},L={key:0,class:"p-8 text-center"},O={key:1,class:"p-8 text-center text-gray-500"},q={key:2,class:"space-y-4"},$={class:"relative"},G={class:"ml-4 flex-1 min-w-0"},J={class:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm"},K={class:"flex justify-between items-start mb-2"},Q={class:"font-medium text-gray-900"},W={class:"text-xs text-gray-500"},X={key:0,class:"text-sm text-gray-600 mb-2"},Y={key:1,class:"text-xs text-gray-500 space-y-1"},Z={key:0},ee={key:0},te={key:1},se={key:1},ae={key:0},oe={key:2},re={key:2,class:"mt-2 text-xs text-gray-400"},le={__name:"ModalHistorial",props:{visible:{type:Boolean,default:!1},reserva:{type:Object,default:()=>null},historial:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["update:visible"],setup(o,{emit:k}){const w=o,C=k,c=l=>l?new Date(l).toLocaleString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",m=l=>new Intl.NumberFormat("es-ES",{style:"currency",currency:"USD"}).format(l||0),R=l=>({creacion:"pi-plus-circle",confirmacion:"pi-check-circle",rechazo:"pi-times-circle",reprogramacion:"pi-calendar",modificacion:"pi-pencil",cancelacion:"pi-ban",pago:"pi-credit-card",comentario:"pi-comment"})[l]||"pi-info-circle",E=l=>({creacion:"text-blue-600 bg-blue-100",confirmacion:"text-green-600 bg-green-100",rechazo:"text-red-600 bg-red-100",reprogramacion:"text-yellow-600 bg-yellow-100",modificacion:"text-purple-600 bg-purple-100",cancelacion:"text-gray-600 bg-gray-100",pago:"text-emerald-600 bg-emerald-100",comentario:"text-indigo-600 bg-indigo-100"})[l]||"text-gray-600 bg-gray-100",z=l=>({creacion:"Reserva Creada",confirmacion:"Reserva Confirmada",rechazo:"Reserva Rechazada",reprogramacion:"Reserva Reprogramada",modificacion:"Reserva Modificada",cancelacion:"Reserva Cancelada",pago:"Pago Registrado",comentario:"Comentario Agregado"})[l.tipo]||"Evento",g=j(()=>[...w.historial].sort((l,t)=>new Date(t.fecha)-new Date(l.fecha))),y=()=>{C("update:visible",!1)};return(l,t)=>{const D=B("Dialog");return a(),M(D,{visible:o.visible,"onUpdate:visible":y,modal:"",header:"Historial de Reserva",style:{width:"800px"},draggable:!1,position:"center",pt:{root:{class:"rounded-lg border border-gray-200"},header:{class:"bg-red-50 border-b px-6 py-4"},content:{class:"p-0"},footer:{class:"border-t px-6 py-4 bg-gray-50"}}},{footer:h(()=>[e("div",{class:"flex justify-end"},[e("button",{class:"bg-gray-500 border border-gray-500 text-white shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300 px-4 py-2 flex items-center gap-2",onClick:y},t[14]||(t[14]=[e("i",{class:"pi pi-times"},null,-1),d(" Cerrar ")]))])]),default:h(()=>{var p,x,b,f,v;return[o.reserva?(a(),r("div",P,[e("div",S,[e("div",H,[e("div",null,[e("h4",T,"Reserva #"+i(o.reserva.id),1),e("div",A,[e("div",null,[t[0]||(t[0]=e("span",{class:"font-medium text-gray-600"},"Cliente:",-1)),e("span",U,i(((x=(p=o.reserva.cliente)==null?void 0:p.user)==null?void 0:x.name)||((b=o.reserva.cliente)==null?void 0:b.nombres)||"-"),1)]),e("div",null,[t[1]||(t[1]=e("span",{class:"font-medium text-gray-600"},"Estado Actual:",-1)),e("span",{class:u(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ml-2",{"bg-yellow-100 text-yellow-800":o.reserva.estado==="Pendiente","bg-green-100 text-green-800":o.reserva.estado==="Confirmado","bg-red-100 text-red-800":o.reserva.estado==="Rechazada","bg-blue-100 text-blue-800":o.reserva.estado==="Reprogramada"}])},i(o.reserva.estado),3)]),e("div",null,[t[2]||(t[2]=e("span",{class:"font-medium text-gray-600"},"Tour/Hotel:",-1)),e("span",V,i(((f=o.reserva.tour)==null?void 0:f.nombre)||((v=o.reserva.hotel)==null?void 0:v.nombre)||"-"),1)]),e("div",null,[t[3]||(t[3]=e("span",{class:"font-medium text-gray-600"},"Precio Total:",-1)),e("span",I,i(m(o.reserva.precio_total)),1)])])])])]),o.loading?(a(),r("div",L,t[4]||(t[4]=[e("div",{class:"inline-flex items-center"},[e("i",{class:"pi pi-spin pi-spinner text-2xl text-red-600 mr-3"}),e("span",{class:"text-gray-600"},"Cargando historial...")],-1)]))):g.value.length===0?(a(),r("div",O,t[5]||(t[5]=[e("i",{class:"pi pi-clock text-4xl text-gray-300 block mb-2"},null,-1),e("span",null,"No hay eventos en el historial",-1)]))):(a(),r("div",q,[t[13]||(t[13]=e("h5",{class:"font-medium text-gray-900 mb-4"},"Cronología de Eventos",-1)),e("div",$,[t[12]||(t[12]=e("div",{class:"absolute left-6 top-0 bottom-0 w-0.5 bg-gray-200"},null,-1)),(a(!0),r(N,null,F(g.value,(s,_)=>(a(),r("div",{key:_,class:"relative flex items-start pb-6"},[e("div",{class:u(["flex-shrink-0 w-12 h-12 rounded-full flex items-center justify-center relative z-10",E(s.tipo)])},[e("i",{class:u(`pi ${R(s.tipo)} text-lg`)},null,2)],2),e("div",G,[e("div",J,[e("div",K,[e("h6",Q,i(z(s)),1),e("span",W,i(c(s.fecha)),1)]),s.descripcion?(a(),r("p",X,i(s.descripcion),1)):n("",!0),s.detalles?(a(),r("div",Y,[s.tipo==="reprogramacion"&&s.detalles.fecha_anterior?(a(),r("div",Z,[t[6]||(t[6]=e("strong",null,"Fecha anterior:",-1)),d(" "+i(c(s.detalles.fecha_anterior))+" ",1),t[7]||(t[7]=e("br",null,null,-1)),t[8]||(t[8]=e("strong",null,"Nueva fecha:",-1)),d(" "+i(c(s.detalles.fecha_nueva))+" ",1),s.detalles.motivo?(a(),r("br",ee)):n("",!0),s.detalles.motivo?(a(),r("strong",te,"Motivo:")):n("",!0),d(" "+i(s.detalles.motivo),1)])):s.tipo==="pago"&&s.detalles.monto?(a(),r("div",se,[t[9]||(t[9]=e("strong",null,"Monto:",-1)),d(" "+i(m(s.detalles.monto))+" ",1),s.detalles.metodo?(a(),r("br",ae)):n("",!0),t[10]||(t[10]=e("strong",null,"Método:",-1)),d(" "+i(s.detalles.metodo),1)])):s.detalles.usuario?(a(),r("div",oe,[t[11]||(t[11]=e("strong",null,"Usuario:",-1)),d(" "+i(s.detalles.usuario),1)])):n("",!0)])):n("",!0),s.usuario?(a(),r("div",re," Por: "+i(s.usuario),1)):n("",!0)])])]))),128))])]))])):n("",!0)]}),_:1},8,["visible"])}}};export{le as default};
