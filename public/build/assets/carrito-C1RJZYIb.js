import{d as A}from"./app-DwNVHcDl.js";import{r as m,a4 as J,E as o}from"./vendor-BOi6Gr0G.js";const V=A("carrito",()=>{const t=m([]),n=m(!1),v=J(),g=o(()=>t.value.reduce((e,a)=>e+a.cantidad,0)),f=o(()=>t.value.reduce((e,a)=>e+a.precio*a.cantidad,0)),S=o(()=>t.value.length===0),_=e=>{const a=t.value.find(i=>i.id===e.id);a?a.cantidad+=1:t.value.push({id:e.id,nombre:e.nombre,precio:e.precio,imagen:e.imagen,stock_actual:e.stock_actual,cantidad:1}),r()},c=e=>{const a=t.value.findIndex(i=>i.id===e);a>-1&&(t.value.splice(a,1),r())},p=(e,a)=>{const i=t.value.find(P=>P.id===e);i&&(a<=0?c(e):a<=i.stock_actual&&(i.cantidad=a,r()))},C=e=>{const a=t.value.find(i=>i.id===e);a&&a.cantidad<a.stock_actual&&(a.cantidad+=1,r())},I=e=>{const a=t.value.find(i=>i.id===e);a&&(a.cantidad<=1?c(e):(a.cantidad-=1,r()))},h=()=>{t.value=[],r()},s=()=>{t.value=[],n.value=!1,localStorage.removeItem("carrito_agencia_vasir")},l=()=>{var i;const e=(i=v.props.auth)==null?void 0:i.user,a=t.value.length>0;!e&&a&&s()},y=()=>{n.value=!n.value},E=()=>{n.value=!0},b=()=>{n.value=!1},r=()=>{localStorage.setItem("carrito_agencia_vasir",JSON.stringify(t.value))},d=()=>{const e=localStorage.getItem("carrito_agencia_vasir");if(e)try{t.value=JSON.parse(e),l()}catch(a){console.error("Error al cargar carrito desde localStorage:",a),t.value=[]}},u=e=>t.value.find(a=>a.id===e),k=e=>t.value.some(a=>a.id===e),x=e=>{const a=u(e);return a?a.cantidad:0};return d(),{items:t,isVisible:n,itemCount:g,totalPrice:f,isEmpty:S,agregarProducto:_,eliminarProducto:c,actualizarCantidad:p,incrementarCantidad:C,decrementarCantidad:I,limpiarCarrito:h,limpiarCarritoAlCerrarSesion:s,toggleVisibility:y,mostrarCarrito:E,ocultarCarrito:b,getItem:u,hasItem:k,getItemQuantity:x,cargarDesdeStorage:d,guardarEnStorage:r,verificarEstadoAutenticacion:l}});export{V as u};
