import{A as se}from"./AuthenticatedLayout-ySbiGZ3w.js";import{c as d,d as i,e,p,t as l,y,x as v,$ as g,a1 as T,q as I,j as oe,F as V,l as q,k as ae,E as le,h as E,r as k,o as ie,a0 as ne,N as F}from"./vendor-BOi6Gr0G.js";import{s as z}from"./app-BoBJFz7I.js";import{A as Z}from"./ui-BibPgP1I.js";import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{e as G}from"./index-Btbp3Gjs.js";import"./logo-DN1bLr27.js";const re={},ce={class:"flex justify-center items-center py-12"};function me(o,u){return i(),d("div",ce,u[0]||(u[0]=[e("div",{class:"text-center"},[e("i",{class:"pi pi-spin pi-spinner text-5xl text-[#d7263d] mb-4"}),e("p",{class:"text-[#d7263d] text-lg font-semibold"},"Cargando datos del dashboard...")],-1)]))}const ue=de(re,[["render",me]]),xe={class:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4"},fe={class:"bg-gradient-to-br from-[#e2a5a5] via-[#d7a1a1] to-[#c98585] rounded-xl shadow-md border border-[#d7a1a1] p-4 sm:p-6 transition-all duration-200 hover:scale-105"},pe={class:"flex items-center justify-between"},be={class:"min-w-0 flex-1"},ge={class:"text-[#7b1f26] text-xs sm:text-sm font-medium opacity-90 truncate"},he={class:"text-[#7b1f26] text-lg sm:text-2xl font-bold mt-1"},ve={class:"p-1.5 sm:p-2 bg-white bg-opacity-30 rounded-lg flex-shrink-0 ml-2"},ye={class:"bg-gradient-to-br from-[#ffe082] via-[#ffd54f] to-[#ffca28] rounded-xl shadow-md border border-[#ffd54f] p-4 sm:p-6 transition-all duration-200 hover:scale-105"},we={class:"flex items-center justify-between"},_e={class:"min-w-0 flex-1"},$e={class:"text-[#a68700] text-xs sm:text-sm font-medium opacity-90 truncate"},ke={class:"text-[#a68700] text-lg sm:text-2xl font-bold mt-1"},je={class:"hidden sm:inline"},Ce={class:"sm:hidden"},De={class:"p-1.5 sm:p-2 bg-white bg-opacity-30 rounded-lg flex-shrink-0 ml-2"},Se={class:"flex items-center justify-between"},Re={class:"min-w-0 flex-1"},Ae={class:"text-[#512da8] text-xs sm:text-sm font-medium opacity-90 truncate"},Me={class:"text-[#512da8] text-lg sm:text-2xl font-bold mt-1"},Le={class:"p-1.5 sm:p-2 bg-white bg-opacity-30 rounded-lg flex-shrink-0 ml-2"},Be={class:"flex items-center justify-between"},Fe={class:"min-w-0 flex-1"},Ve={class:"text-[#1565c0] text-xs sm:text-sm font-medium opacity-90 truncate"},Pe={class:"text-[#1565c0] text-lg sm:text-2xl font-bold mt-1"},Ee={class:"p-1.5 sm:p-2 bg-white bg-opacity-30 rounded-lg flex-shrink-0 ml-2"},Te={__name:"MetricasCard",props:{metrics:{type:Array,required:!0},dashboardData:{type:Object,required:!0},formatValueForMobile:{type:Function,required:!0}},setup(o){return(u,t)=>(i(),d("div",xe,[e("div",fe,[e("div",pe,[e("div",be,[e("p",ge,l(o.metrics[0].label),1),e("p",he,l(o.metrics[0].value),1)]),e("div",ve,[e("i",{class:y(o.metrics[0].icon+" text-[#7b1f26] text-lg sm:text-xl")},null,2)])])]),e("div",ye,[e("div",we,[e("div",_e,[e("p",$e,l(o.metrics[1].label),1),e("p",ke,[e("span",je,l(o.metrics[1].value),1),e("span",Ce,l(o.formatValueForMobile(o.metrics[1].value,o.dashboardData.inventario)),1)])]),e("div",De,[e("i",{class:y(o.metrics[1].icon+" text-[#a68700] text-lg sm:text-xl")},null,2)])])]),p(g(T),{href:"/gestion-reserva-tours",class:"bg-gradient-to-br from-[#b39ddb] via-[#9575cd] to-[#7e57c2] rounded-xl shadow-md border border-[#9575cd] p-4 sm:p-6 cursor-pointer transform transition-all duration-200 hover:scale-105 hover:shadow-lg active:scale-95 block"},{default:v(()=>[e("div",Se,[e("div",Re,[e("p",Ae,l(o.metrics[2].label),1),e("p",Me,l(o.metrics[2].value),1),t[0]||(t[0]=e("p",{class:"text-[#512da8] text-xs opacity-80 mt-1 hidden sm:block"},"Click para ver todas",-1)),t[1]||(t[1]=e("p",{class:"text-[#512da8] text-xs opacity-80 mt-1 sm:hidden"},"Tap aquí",-1))]),e("div",Le,[e("i",{class:y(o.metrics[2].icon+" text-[#512da8] text-lg sm:text-xl")},null,2)])])]),_:1}),p(g(T),{href:"/tours",class:"bg-gradient-to-br from-[#90caf9] via-[#64b5f6] to-[#42a5f5] rounded-xl shadow-md border border-[#64b5f6] p-4 sm:p-6 cursor-pointer transform transition-all duration-200 hover:scale-105 hover:shadow-lg active:scale-95 block"},{default:v(()=>[e("div",Be,[e("div",Fe,[e("p",Ve,l(o.metrics[3].label),1),e("p",Pe,l(o.metrics[3].value),1),t[2]||(t[2]=e("p",{class:"text-[#1565c0] text-xs opacity-80 mt-1 hidden sm:block"},"Click para gestionar",-1)),t[3]||(t[3]=e("p",{class:"text-[#1565c0] text-xs opacity-80 mt-1 sm:hidden"},"Tap aquí",-1))]),e("div",Ee,[e("i",{class:y(o.metrics[3].icon+" text-[#1565c0] text-lg sm:text-xl")},null,2)])])]),_:1})]))}},qe={class:"lg:space-y-4 grid grid-cols-2 lg:grid-cols-1 gap-3 lg:gap-4"},Ne={class:"flex items-stretch min-w-0"},Oe={class:"flex-1 p-4 sm:p-6 flex flex-col justify-center min-w-0"},Ie={class:"flex items-center justify-between min-w-0"},ze={class:"min-w-0 flex-1 font-sans"},He={class:"text-xs sm:text-sm font-medium text-gray-700 truncate"},We={class:"text-lg sm:text-xl font-bold text-gray-900 mt-1"},Ze={class:"flex items-center justify-center shrink-0 w-8 h-8 sm:w-10 sm:h-10 bg-white/40 rounded-full overflow-hidden ml-2"},Ge={class:"flex items-stretch min-w-0"},Ue={class:"flex-1 p-4 sm:p-6 flex flex-col justify-center min-w-0"},Ye={class:"flex items-center justify-between min-w-0"},Je={class:"min-w-0 flex-1 font-sans"},Ke={class:"text-xs sm:text-sm font-medium text-gray-700 truncate"},Qe={class:"text-lg sm:text-xl font-bold text-gray-900 mt-1"},Xe={class:"flex items-center justify-center shrink-0 w-8 h-8 sm:w-10 sm:h-10 bg-white/40 rounded-full overflow-hidden ml-2"},et={class:"p-0 rounded-2xl border-2 border-solid col-span-2 lg:col-span-1 bg-gradient-to-br from-[#b2f7e7] via-[#a0f2da] to-[#7ae6c8] shadow-md border-[#a0f2da] transition-all duration-200 hover:scale-105 hover:shadow-lg active:scale-95 cursor-pointer max-w-full"},tt={class:"flex items-stretch min-w-0"},st={class:"flex-1 p-4 sm:p-6 flex flex-col justify-center min-w-0"},ot={class:"flex items-center justify-between min-w-0"},at={class:"min-w-0 flex-1 font-sans"},lt={class:"text-xs sm:text-sm font-medium text-gray-700 truncate"},it={class:"text-lg sm:text-xl font-bold text-gray-900 mt-1"},nt={class:"hidden sm:inline"},dt={class:"sm:hidden"},rt={class:"flex items-center justify-center shrink-0 w-8 h-8 sm:w-10 sm:h-10 bg-white/40 rounded-full overflow-hidden ml-2"},ct={__name:"WidgetsSecundarios",props:{widgets:{type:Array,required:!0},dashboardData:{type:Object,required:!0},formatValueForMobile:{type:Function,required:!0}},emits:["toggle-reservas-modal","toggle-stock-modal"],setup(o){return(u,t)=>(i(),d("div",qe,[e("div",{class:"p-0 rounded-2xl border-2 border-solid bg-gradient-to-br from-[#f7e7b2] via-[#f2daa0] to-[#e6c87a] shadow-md border-[#f2daa0] transition-all duration-200 hover:scale-105 hover:shadow-lg active:scale-95 cursor-pointer max-w-full",onClick:t[0]||(t[0]=s=>u.$emit("toggle-reservas-modal"))},[e("div",Ne,[t[5]||(t[5]=e("div",{class:"hidden md:block w-2 rounded-l-2xl bg-yellow-400"},null,-1)),e("div",Oe,[e("div",Ie,[e("div",ze,[e("p",He,l(o.widgets[0].title),1),t[2]||(t[2]=e("hr",{class:"my-2 border-t-2 border-gray-200 opacity-30"},null,-1)),e("p",We,l(o.widgets[0].value),1),t[3]||(t[3]=e("p",{class:"text-xs text-gray-500 mt-1 hidden sm:block"},"Click para ver detalles",-1)),t[4]||(t[4]=e("p",{class:"text-xs text-gray-500 mt-1 sm:hidden"},"Tap detalles",-1))]),e("div",Ze,[e("i",{class:y(o.widgets[0].icon+" text-base sm:text-xl "+o.widgets[0].iconColor)},null,2)])])])])]),e("div",{class:"p-0 rounded-2xl border-2 border-solid bg-gradient-to-br from-[#f5b8b8] via-[#e7a6a6] to-[#d88a8a] shadow-md border-[#e7a6a6] transition-all duration-200 hover:scale-105 hover:shadow-lg active:scale-95 cursor-pointer max-w-full",onClick:t[1]||(t[1]=s=>u.$emit("toggle-stock-modal"))},[e("div",Ge,[t[9]||(t[9]=e("div",{class:"hidden md:block w-2 rounded-l-2xl bg-red-400"},null,-1)),e("div",Ue,[e("div",Ye,[e("div",Je,[e("p",Ke,l(o.widgets[1].title),1),t[6]||(t[6]=e("hr",{class:"my-2 border-t-2 border-gray-200 opacity-30"},null,-1)),e("p",Qe,l(o.widgets[1].value),1),t[7]||(t[7]=e("p",{class:"text-xs text-gray-500 mt-1 hidden sm:block"},"Click para ver productos",-1)),t[8]||(t[8]=e("p",{class:"text-xs text-gray-500 mt-1 sm:hidden"},"Ver productos",-1))]),e("div",Xe,[e("i",{class:y(o.widgets[1].icon+" text-base sm:text-xl "+o.widgets[1].iconColor)},null,2)])])])])]),e("div",et,[e("div",tt,[t[11]||(t[11]=e("div",{class:"hidden md:block w-2 rounded-l-2xl bg-green-400"},null,-1)),e("div",st,[e("div",ot,[e("div",at,[e("p",lt,l(o.widgets[2].title),1),t[10]||(t[10]=e("hr",{class:"my-2 border-t-2 border-gray-200 opacity-30"},null,-1)),e("p",it,[e("span",nt,l(o.widgets[2].value),1),e("span",dt,l(o.formatValueForMobile(o.widgets[2].value,o.dashboardData.inventario)),1)])]),e("div",rt,[e("i",{class:y(o.widgets[2].icon+" text-base sm:text-xl "+o.widgets[2].iconColor)},null,2)])])])])])]))}},mt={class:"bg-gray-50 rounded-lg shadow-xl border border-gray-100 p-4 sm:p-6"},ut={class:"space-y-2 sm:space-y-3 max-h-48 sm:max-h-64 overflow-y-auto"},xt={class:"flex items-center space-x-2 sm:space-x-3 min-w-0 flex-1"},ft={class:"min-w-0 flex-1"},pt={class:"text-xs sm:text-sm font-medium text-gray-900 truncate"},bt={class:"text-xs text-gray-500"},gt={class:"text-xs sm:text-sm font-semibold text-yellow-600 flex-shrink-0 ml-2"},ht={class:"hidden sm:inline"},vt={class:"sm:hidden"},yt={class:"flex items-center space-x-2 sm:space-x-3 min-w-0 flex-1"},wt={class:"min-w-0 flex-1"},_t={class:"text-xs sm:text-sm font-medium text-gray-900 truncate"},$t={class:"text-xs text-gray-500 truncate"},kt={class:"hidden sm:inline"},jt={class:"sm:hidden"},Ct={key:0,class:"text-center py-6 sm:py-8"},Dt={__name:"ActividadReciente",props:{dashboardData:{type:Object,required:!0},formatValueForMobile:{type:Function,required:!0}},setup(o){return(u,t)=>(i(),d("div",mt,[t[2]||(t[2]=e("h3",{class:"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4 tracking-wide"},[e("i",{class:"pi pi-clock text-blue-500 mr-2"}),I(" Actividad Reciente ")],-1)),e("div",ut,[(i(!0),d(V,null,q((o.dashboardData.ventas||[]).slice(0,3),s=>(i(),d("div",{key:"venta-"+s.id,class:"flex items-center justify-between p-2 sm:p-3 bg-white rounded-lg border border-gray-100 shadow-sm"},[e("div",xt,[t[0]||(t[0]=e("div",{class:"p-1.5 sm:p-2 bg-yellow-100 rounded-full flex-shrink-0"},[e("i",{class:"pi pi-shopping-cart text-yellow-500 text-xs sm:text-sm"})],-1)),e("div",ft,[e("p",pt,"Venta #"+l(s.id),1),e("p",bt,l(new Date(s.fecha).toLocaleDateString("es-ES")),1)])]),e("span",gt,[e("span",ht,"$"+l(Number(s.total||0).toLocaleString("es-ES")),1),e("span",vt,"$"+l(o.formatValueForMobile("$"+(s.total||0))),1)])]))),128)),(i(!0),d(V,null,q((o.dashboardData.reservas||[]).slice(0,3),s=>(i(),d("div",{key:"reserva-"+s.id,class:y(["flex items-center justify-between p-2 sm:p-3 rounded-lg border shadow-sm bg-white",{"border-blue-100":s.estado&&s.estado.toLowerCase()==="pendiente","border-green-100":s.estado&&s.estado.toLowerCase()==="confirmada","border-red-100":s.estado&&s.estado.toLowerCase()==="rechazada","border-purple-100":s.estado&&s.estado.toLowerCase()==="completado"}])},[e("div",yt,[e("div",{class:y(["p-1.5 sm:p-2 rounded-full flex-shrink-0",{"bg-blue-100":s.estado&&s.estado.toLowerCase()==="pendiente","bg-green-100":s.estado&&s.estado.toLowerCase()==="confirmada","bg-red-100":s.estado&&s.estado.toLowerCase()==="rechazada","bg-purple-100":s.estado&&s.estado.toLowerCase()==="completado"}])},[e("i",{class:y(["pi pi-calendar text-xs sm:text-sm",{"text-blue-500":s.estado&&s.estado.toLowerCase()==="pendiente","text-green-500":s.estado&&s.estado.toLowerCase()==="confirmada","text-red-500":s.estado&&s.estado.toLowerCase()==="rechazada","text-purple-500":s.estado&&s.estado.toLowerCase()==="completado"}])},null,2)],2),e("div",wt,[e("p",_t,l(s.entidad_nombre||"Reserva"),1),e("p",$t,l(s.cliente&&s.cliente.user&&s.cliente.user.name||s.cliente&&s.cliente.nombres||"Cliente no asignado"),1)])]),e("span",{class:y(["inline-flex px-2 sm:px-3 py-1 text-xs font-bold rounded-full flex-shrink-0 ml-2 shadow",{"bg-yellow-100 text-yellow-800":s.estado&&s.estado.toLowerCase()==="pendiente","bg-green-100 text-green-800":s.estado&&s.estado.toLowerCase()==="confirmada","bg-red-100 text-red-800":s.estado&&s.estado.toLowerCase()==="rechazada","bg-purple-100 text-purple-800":s.estado&&s.estado.toLowerCase()==="completado"}])},[e("span",kt,l(s.estado),1),e("span",jt,l(s.estado?s.estado.substring(0,3):""),1)],2)],2))),128)),(!o.dashboardData.ventas||o.dashboardData.ventas.length===0)&&(!o.dashboardData.reservas||o.dashboardData.reservas.length===0)?(i(),d("div",Ct,t[1]||(t[1]=[e("i",{class:"pi pi-info-circle text-gray-400 text-xl sm:text-2xl mb-2"},null,-1),e("p",{class:"text-gray-500 text-xs sm:text-sm font-semibold"},"No hay actividad reciente",-1)]))):oe("",!0)])]))}},St={class:"space-y-3 overflow-y-auto max-h-[60vh] sm:max-h-[70vh] px-2 sm:px-0"},Rt={key:0,class:"space-y-3"},At={class:"flex items-center justify-between"},Mt={class:"flex items-center space-x-3 flex-1 min-w-0"},Lt={class:"flex-1 min-w-0"},Bt={class:"font-medium text-gray-900 text-sm truncate"},Ft={class:"text-xs text-gray-600 truncate"},Vt={class:"text-xs text-gray-500"},Pt={class:"text-right flex-shrink-0 ml-4"},Et={class:"font-semibold text-gray-900 text-sm"},Tt={class:"text-xs text-amber-600"},qt={key:1,class:"text-center py-6 sm:py-8"},Nt={class:"flex justify-end gap-2 mt-4 pt-4 border-t border-gray-200"},Ot={class:"space-y-3 overflow-y-auto max-h-[60vh] sm:max-h-[70vh] px-2 sm:px-0"},It={key:0,class:"space-y-3"},zt={class:"flex items-center justify-between"},Ht={class:"flex items-center space-x-3 flex-1 min-w-0"},Wt={class:"flex-1 min-w-0"},Zt={class:"font-medium text-gray-900 text-sm truncate"},Gt={class:"text-xs text-gray-600 truncate"},Ut={class:"text-right flex-shrink-0 ml-4"},Yt={class:"flex flex-col sm:flex-row sm:items-center space-y-1 sm:space-y-0 sm:space-x-2"},Jt={class:"px-2 py-1 bg-red-100 text-red-800 text-xs font-semibold rounded-full"},Kt={class:"text-xs text-gray-500"},Qt={class:"text-sm font-semibold text-gray-900 mt-1"},Xt={key:1,class:"text-center py-6 sm:py-8"},es={class:"flex justify-end gap-2 mt-4 pt-4 border-t border-gray-200"},ts={__name:"ModalesInteractivos",props:{showReservasPendientesModal:{type:Boolean,required:!0},showProductosStockBajoModal:{type:Boolean,required:!0},dashboardData:{type:Object,required:!0}},emits:["close-reservas-modal","close-stock-modal"],setup(o){return(u,t)=>{const s=ae("Dialog");return i(),d(V,null,[p(s,{visible:o.showReservasPendientesModal,modal:"",draggable:!1,closable:!0,dismissableMask:!0,class:"mx-2 sm:mx-4",style:{width:"98vw",maxWidth:"36rem",maxHeight:"calc(100vh - 20px)",padding:"0"},baseZIndex:1e4,"onUpdate:visible":t[0]||(t[0]=a=>u.$emit("close-reservas-modal"))},{header:v(()=>t[2]||(t[2]=[e("div",{class:"flex items-center"},[e("i",{class:"pi pi-clock text-amber-500 mr-2"}),e("span",{class:"text-base sm:text-lg font-semibold text-gray-900"},"Reservas Pendientes")],-1)])),footer:v(()=>[e("div",Nt,[p(g(T),{href:"/gestion-reserva-tours",class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2"},{default:v(()=>[p(g(Z),{icon:g(G),class:"h-5 text-white"},null,8,["icon"]),t[5]||(t[5]=I(" Ver Reservas "))]),_:1,__:[5]})])]),default:v(()=>[e("div",St,[o.dashboardData.reservas&&o.dashboardData.reservas.filter(a=>a.estado&&a.estado.toLowerCase()==="pendiente").length>0?(i(),d("div",Rt,[(i(!0),d(V,null,q(o.dashboardData.reservas.filter(a=>a.estado&&a.estado.toLowerCase()==="pendiente"),a=>(i(),d("div",{key:a.id,class:"bg-red-50 rounded-lg border border-red-200 hover:bg-red-100 transition-colors p-3 sm:p-4"},[e("div",At,[e("div",Mt,[t[3]||(t[3]=e("div",{class:"p-2 bg-red-100 rounded-full flex-shrink-0"},[e("i",{class:"pi pi-calendar text-red-600 text-sm"})],-1)),e("div",Lt,[e("h4",Bt,l(a.entidad_nombre||"Tour no especificado"),1),e("p",Ft,l(a.cliente&&a.cliente.user&&a.cliente.user.name||a.cliente&&a.cliente.nombres||"Cliente no asignado"),1),e("p",Vt,l(new Date(a.fecha_reserva||a.fecha).toLocaleDateString("es-ES")),1)])]),e("div",Pt,[e("p",Et,"$"+l(Number(a.total||0).toLocaleString("es-ES")),1),e("p",Tt,l(a.mayores_edad||0)+" adultos, "+l(a.menores_edad||0)+" niños",1)])])]))),128))])):(i(),d("div",qt,t[4]||(t[4]=[e("i",{class:"pi pi-check-circle text-green-400 text-3xl sm:text-4xl mb-3"},null,-1),e("p",{class:"text-gray-500 text-sm sm:text-base"},"¡Excelente! No hay reservas pendientes",-1)])))])]),_:1},8,["visible"]),p(s,{visible:o.showProductosStockBajoModal,modal:"",draggable:!1,closable:!0,dismissableMask:!0,class:"mx-2 sm:mx-4",style:{width:"98vw",maxWidth:"36rem",maxHeight:"calc(100vh - 20px)",padding:"0"},baseZIndex:1e4,"onUpdate:visible":t[1]||(t[1]=a=>u.$emit("close-stock-modal"))},{header:v(()=>t[6]||(t[6]=[e("div",{class:"flex items-center"},[e("i",{class:"pi pi-exclamation-triangle text-red-500 mr-2"}),e("span",{class:"text-base sm:text-lg font-semibold text-gray-900"},[e("span",{class:"hidden sm:inline"},"Productos con Stock Bajo"),e("span",{class:"sm:hidden"},"Stock Bajo")])],-1)])),footer:v(()=>[e("div",es,[p(g(T),{href:"/productos",class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2"},{default:v(()=>[p(g(Z),{icon:g(G),class:"h-5 text-white"},null,8,["icon"]),t[9]||(t[9]=I(" Gestionar Inventario "))]),_:1,__:[9]})])]),default:v(()=>[e("div",Ot,[o.dashboardData.stockBajo&&o.dashboardData.stockBajo.length>0?(i(),d("div",It,[(i(!0),d(V,null,q(o.dashboardData.stockBajo,a=>{var f;return i(),d("div",{key:a.id,class:"bg-red-50 rounded-lg border border-red-200 hover:bg-red-100 transition-colors p-3 sm:p-4"},[e("div",zt,[e("div",Ht,[t[7]||(t[7]=e("div",{class:"p-2 bg-red-100 rounded-full flex-shrink-0"},[e("i",{class:"pi pi-box text-red-600 text-sm"})],-1)),e("div",Wt,[e("h4",Zt,l(a.nombre),1),e("p",Gt,"Categoría: "+l(((f=a.categoria)==null?void 0:f.nombre)||"Sin categoría"),1)])]),e("div",Ut,[e("div",Yt,[e("span",Jt," Stock: "+l(a.stock_actual),1),e("span",Kt," Min: "+l(a.stock_minimo),1)]),e("p",Qt," $"+l(Number(a.precio||0).toLocaleString("es-ES")),1)])])])}),128))])):(i(),d("div",Xt,t[8]||(t[8]=[e("i",{class:"pi pi-check-circle text-green-400 text-3xl sm:text-4xl mb-3"},null,-1),e("p",{class:"text-gray-500 text-sm sm:text-base"},"¡Perfecto! Todos los productos tienen stock suficiente",-1)])))])]),_:1},8,["visible"])],64)}}},ss={class:"bg-gray-50 rounded-lg shadow-xl border border-[#fbeee6] p-4 sm:p-6 mt-4 sm:mt-6"},os={class:"h-48 sm:h-64"},as={key:1,class:"flex items-center justify-center h-full"},ls={__name:"GraficosSection",props:{resumenReservasData:{type:Array,required:!1,default:()=>[]},reservasData:{type:Array,required:!1,default:()=>[]}},setup(o){const u=o,t={maintainAspectRatio:!1,plugins:{title:{display:!0,text:"Tours Más Reservados",font:{size:18}},legend:{display:!0,position:"bottom",labels:{usePointStyle:!0,color:"#374151"}},tooltip:{callbacks:{label:function(a){return`${a.label}: ${a.parsed} reservas`}}}}},s=le(()=>{const a={},f=u.resumenReservasData,h=u.reservasData;f&&f.length>0&&f.forEach(n=>{if(n.tipo==="tours"&&n.nombre){const b=(n.total_pendientes||0)+(n.total_confirmadas||0);if(b>0){const M=n.nombre.length>30?n.nombre.substring(0,27)+"...":n.nombre;a[M]=b}}}),Object.keys(a).length===0&&h&&h.length>0&&h.forEach(n=>{if(n.entidad_nombre){const b=n.entidad_nombre.length>30?n.entidad_nombre.substring(0,27)+"...":n.entidad_nombre;a[b]=(a[b]||0)+1}});let w=Object.entries(a).sort(([,n],[,b])=>b-n).slice(0,5);return w.length===0&&(w=[["Sin reservas",0]]),{labels:w.map(([n])=>n),datasets:[{label:"Tours Más Reservados",data:w.map(([,n])=>n),backgroundColor:["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6"]}]}});return(a,f)=>(i(),d("div",ss,[f[1]||(f[1]=e("h3",{class:"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4"},[e("i",{class:"pi pi-star text-yellow-500 mr-2"}),e("span",{class:"hidden sm:inline"},"Top 5 Tours Más Reservados"),e("span",{class:"sm:hidden"},"Top Tours")],-1)),e("div",os,[s.value?(i(),E(g(z),{key:0,type:"doughnut",data:s.value,options:t,class:"w-full h-full"},null,8,["data"])):(i(),d("div",as,f[0]||(f[0]=[e("p",{class:"text-gray-500 text-xs sm:text-sm"},"No hay reservas registradas",-1)])))])]))}},is={key:1,class:"px-2 sm:px-4 lg:px-6 py-4 sm:py-6 space-y-4 sm:space-y-6 mt-1 sm:mt-1"},ns={class:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6"},ds={class:"bg-white rounded-lg shadow-sm border border-gray-100 p-4 sm:p-6"},rs={class:"h-48 sm:h-64"},cs={key:1,class:"flex items-center justify-center h-full"},ms={class:"bg-white rounded-lg shadow-sm border border-gray-100 p-4 sm:p-6"},us={class:"h-48 sm:h-64"},xs={key:1,class:"flex items-center justify-center h-full"},fs={class:"grid grid-cols-1 xl:grid-cols-2 gap-4 sm:gap-6"},_s={__name:"Dashboard",setup(o){const u=k(),t=k(),s=k(),a=k(),f=k(!0),h=k({}),w=k([{label:"Ventas Hoy",value:"0",icon:"pi pi-shopping-cart",color:"from-[#ef233c] to-[#d90429]",text:"text-[#7b1f26]",key:"ventas_hoy",category:"ventas",description:"Ventas del día"},{label:"Ingresos Hoy",value:"$0",icon:"pi pi-dollar",color:"from-[#ffd600] to-[#ffb700]",text:"text-[#a68700]",key:"ingresos_hoy",category:"ventas",description:"Ingresos del día"},{label:"Reservas del Mes",value:"0",icon:"pi pi-calendar-plus",color:"from-[#6c00f9] to-[#480ca8]",text:"text-[#240046]",key:"reservas_mes",category:"reservas",description:"Reservas este mes"},{label:"Tours Activos",value:"0",icon:"pi pi-map-marker",color:"from-[#0077b6] to-[#023e8a]",text:"text-[#03045e]",key:"tours_activos",category:"reservas",description:"Tours disponibles"}]),n=k([{title:"Reservas Pendientes",value:"0",icon:"pi pi-clock",color:"bg-[#fff3b0] border-[#ffd600]",iconColor:"text-[#ffd600]",key:"reservas_pendientes"},{title:"Productos Stock Bajo",value:"0",icon:"pi pi-exclamation-triangle",color:"bg-[#ffe5e5] border-[#ef233c]",iconColor:"text-[#d90429]",key:"productos_stock_bajo"},{title:"Valor Inventario",value:"$0",icon:"pi pi-wallet",color:"bg-[#e5daff] border-[#6c00f9]",iconColor:"text-[#480ca8]",key:"valor_total_inventario"},{title:"Clientes Activos",value:"0",icon:"pi pi-users",color:"bg-[#d0f1ff] border-[#0077b6]",iconColor:"text-[#023e8a]",key:"clientes_activos"}]),b=k(!1),M=k(!1),U=()=>{b.value=!b.value},Y=()=>{M.value=!M.value},N=(r,c=null)=>{if(r.includes("$")){let x;return c&&c.valor_total_inventario?x=parseFloat(c.valor_total_inventario):x=parseFloat(r.replace(/[$,.\s]/g,"")),isNaN(x)?"$0":x>=1e6?"$"+(x/1e6).toFixed(1)+"M":x>=1e3?"$"+(x/1e3).toFixed(0)+"k":"$"+x.toFixed(0)}return r},J=async()=>{f.value=!0;try{const r=await F.get("/api/inventario/resumen",{headers:{Accept:"application/json"}}),c=await F.get("/api/ventas",{headers:{Accept:"application/json"}}),x=await F.get("/api/inventario/stock-bajo",{headers:{Accept:"application/json"}}),L=await F.get("/api/reservas?per_page=50",{headers:{Accept:"application/json"}}),B=await F.get("/api/reservas/resumen",{headers:{Accept:"application/json"}}),S=await F.get("/api/tours",{headers:{Accept:"application/json"}}),_=r.data.data||r.data,C=c.data.data||c.data||[],R=x.data.data||x.data||[],A=L.data.data||L.data||[],$=B.data.data||B.data||[],D=S.data.data||S.data||[];H(_,C,A,$,D),W(_,C,R,A,$),h.value={inventario:_,ventas:C,stockBajo:R,reservas:A,resumenReservas:$,tours:D}}catch(r){console.error("Error al cargar datos del dashboard:",r),H({},[],[],[],[]),W({},[],[],[])}finally{f.value=!1}},H=(r,c,x,L,B)=>{const S=Array.isArray(c)?c:[],_=Array.isArray(x)?x:[],C=Array.isArray(B)?B:[],R=new Date().toISOString().split("T")[0],A=S.filter(m=>m.fecha?m.fecha.split("T")[0]===R:!1).length,$=S.filter(m=>m.fecha?m.fecha.split("T")[0]===R:!1).reduce((m,j)=>m+(parseFloat(j.total)||0),0),D=new Date().getMonth(),O=new Date().getFullYear(),P=_.filter(m=>{if(!m.fecha_reserva&&!m.fecha)return!1;const j=new Date(m.fecha_reserva||m.fecha);return j.getMonth()===D&&j.getFullYear()===O}).length,X=C.filter(m=>!m.estado||m.estado.toLowerCase()==="activo"||m.estado.toLowerCase()==="disponible").length;w.value[0].value=A.toString(),w.value[1].value=`$${$.toLocaleString("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2})}`,w.value[2].value=P.toString(),w.value[3].value=X.toString();const ee=_.filter(m=>m.estado&&m.estado.toLowerCase()==="pendiente").length,te=new Set(_.map(m=>{var j;return(j=m.cliente)==null?void 0:j.id}).filter(m=>m)).size;n.value[0].value=ee.toString(),n.value[1].value=(r.productos_stock_bajo||0).toString(),n.value[2].value=`$${Number(r.valor_total_inventario||0).toLocaleString("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2})}`,n.value[3].value=te.toString()},W=(r,c,x,L,B)=>{const S=r.total_productos||0,_=r.productos_stock_bajo||0,C=r.productos_agotados||0,R=r.productos_disponibles||Math.max(0,S-_-C),A=Array.isArray(L)?L:[];u.value={labels:["Productos Disponibles","Stock Bajo","Agotados"],datasets:[{label:"Estado del Inventario",data:[R,_,C],backgroundColor:["#10b981","#f59e0b","#ef4444"],hoverBackgroundColor:["#34d399","#fbbf24","#f87171"]}]};const $=A.reduce((D,O)=>{const P=O.estado||"Sin estado";return D[P]=(D[P]||0)+1,D},{});Object.keys($).length===0&&($["Sin reservas"]=0),t.value={labels:Object.keys($),datasets:[{label:"Reservas por Estado",data:Object.values($),backgroundColor:["#f59e0b","#10b981","#ef4444","#3b82f6"]}]}},K=()=>({maintainAspectRatio:!1,plugins:{title:{display:!0,text:"Estado del Inventario",font:{size:18}},legend:{display:!0,position:"bottom",labels:{usePointStyle:!0,color:"#374151"}},tooltip:{callbacks:{label:function(r){return`${r.label}: ${r.parsed} productos`}}}}}),Q=()=>({maintainAspectRatio:!1,plugins:{title:{display:!0,text:"Reservas por Estado",font:{size:18}},legend:{display:!1},tooltip:{callbacks:{label:function(r){return`${r.label}: ${r.parsed.y} reservas`}}}},scales:{x:{ticks:{color:"#374151"},grid:{color:"#e5e7eb"}},y:{beginAtZero:!0,ticks:{color:"#374151"},grid:{color:"#e5e7eb"}}}});return ie(()=>{s.value=K(),a.value=Q(),J()}),(r,c)=>(i(),d(V,null,[p(g(ne),{title:"Dashboard"}),p(se,null,{default:v(()=>[f.value?(i(),E(ue,{key:0})):(i(),d("div",is,[p(Te,{metrics:w.value,"dashboard-data":h.value,"format-value-for-mobile":N},null,8,["metrics","dashboard-data"]),e("div",ns,[p(ct,{widgets:n.value,"dashboard-data":h.value,"format-value-for-mobile":N,onToggleReservasModal:U,onToggleStockModal:Y},null,8,["widgets","dashboard-data"]),e("div",ds,[c[3]||(c[3]=e("h3",{class:"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4"},"Inventario por Estado",-1)),e("div",rs,[u.value?(i(),E(g(z),{key:0,type:"pie",data:u.value,options:s.value,class:"w-full h-full"},null,8,["data","options"])):(i(),d("div",cs,c[2]||(c[2]=[e("p",{class:"text-gray-500 text-xs sm:text-sm"},"No hay datos de inventario",-1)])))])]),e("div",ms,[c[5]||(c[5]=e("h3",{class:"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4"},"Reservas por Estado",-1)),e("div",us,[t.value?(i(),E(g(z),{key:0,type:"bar",data:t.value,options:a.value,class:"w-full h-full"},null,8,["data","options"])):(i(),d("div",xs,c[4]||(c[4]=[e("p",{class:"text-gray-500 text-xs sm:text-sm"},"No hay datos de reservas",-1)])))])])]),e("div",fs,[p(ls,{"resumen-reservas-data":h.value.resumenReservas,"reservas-data":h.value.reservas},null,8,["resumen-reservas-data","reservas-data"]),p(Dt,{"dashboard-data":h.value,"format-value-for-mobile":N},null,8,["dashboard-data"])])])),p(ts,{"show-reservas-pendientes-modal":b.value,"show-productos-stock-bajo-modal":M.value,"dashboard-data":h.value,onCloseReservasModal:c[0]||(c[0]=x=>b.value=!1),onCloseStockModal:c[1]||(c[1]=x=>M.value=!1)},null,8,["show-reservas-pendientes-modal","show-productos-stock-bajo-modal","dashboard-data"])]),_:1})],64))}};export{_s as default};
