import{r as d,E as Y,w as Z,n as A,o as ee,N as _,k as w,c as E,d as T,p as s,$ as o,a0 as ae,x as n,e as a,a1 as te,t as y,q as b,j as S,y as oe,F as se}from"./vendor-BOi6Gr0G.js";import{A as le}from"./AuthenticatedLayout-ySbiGZ3w.js";import{z as re,F as ne,A as u}from"./ui-BibPgP1I.js";import{f as ie,a as de,b as F,c as ue,d as j,e as M,g as $,h as ce}from"./index-Btbp3Gjs.js";import"./logo-DN1bLr27.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const me={class:"py-4 sm:py-6 px-4 sm:px-7 mt-6 sm:mt-10 mx-auto bg-red-50 shadow-md rounded-lg h-screen-full"},ge={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 gap-2 sm:gap-0"},ve={class:"flex items-center gap-3"},be={class:"bg-blue-50 p-3 rounded-lg shadow-sm border mb-4"},fe={class:"text-sm font-medium leading-relaxed"},pe={class:"flex gap-1 justify-center items-center w-64"},xe=["onClick"],he=["onClick"],we={class:"space-y-4"},ye={class:"w-full flex flex-col"},Ce={class:"flex items-center gap-4"},Pe={key:0,class:"text-red-500 ml-28"},ke={key:1,class:"text-orange-500 ml-28"},_e={key:2,class:"text-red-500 ml-28"},Ee={class:"flex justify-center gap-4 w-full"},Te={class:"flex items-center gap-3"},Ne={class:"flex flex-col"},De={class:"flex justify-center gap-4 w-full"},Le={class:"flex items-center gap-3"},Ae={class:"flex justify-center gap-3 w-full"},$e={__name:"CategoriaProductos",setup(Se){const m=re(),O=d([]),t=d({id:null,nombre:""}),g=d(!1),f=d(!1),h=d(!1),p=d(!1),x=d(!1),v=d(null),C=d({global:{value:null,matchMode:ne.CONTAINS}}),N=d(10),z=d([5,10,20,50]),P=d("Guardar"),I=Y(()=>{let l=O.value;if(C.value.global.value){const e=C.value.global.value.toLowerCase();l=l.filter(i=>i.nombre.toLowerCase().includes(e))}return l});Z([t],()=>{v.value&&g.value&&A(()=>{const l={...t.value},e=JSON.stringify(l)!==JSON.stringify(v.value),i=!v.value.id,c=t.value.nombre;x.value=e||i&&c})},{deep:!0,flush:"post"});function k(){t.value={id:null,nombre:""},p.value=!1}ee(()=>{D()});const D=async()=>{try{const l=await _.get("/api/categorias-productos");O.value=(l.data.data||l.data||[]).map(e=>({...e,categoria_id:e.id})).sort((e,i)=>new Date(i.created_at)-new Date(e.created_at))}catch{m.add({severity:"error",summary:"Error",detail:"No se pudieron cargar las categor√≠as de productos.",life:4e3})}},R=()=>{k(),P.value="Guardar",p.value=!1,g.value=!0,A(()=>{v.value={...t.value},x.value=!1})},B=l=>{k(),p.value=!1,t.value={...l},P.value="Actualizar",g.value=!0,A(()=>{v.value={...t.value},x.value=!1})},q=async()=>{var l,e;if(p.value=!0,!t.value.nombre||t.value.nombre.length<3||t.value.nombre.length>50){m.add({severity:"warn",summary:"Campos requeridos",detail:"El nombre debe tener entre 3 y 50 caracteres.",life:4e3});return}try{t.value.id?(await _({method:"POST",url:`/api/categorias-productos/${t.value.id}`,data:{_method:"PUT",nombre:t.value.nombre}}),m.add({severity:"success",summary:"¬°√âxito!",detail:"La categor√≠a ha sido actualizada correctamente.",life:5e3})):(await _.post("/api/categorias-productos",{nombre:t.value.nombre}),m.add({severity:"success",summary:"¬°√âxito!",detail:"La categor√≠a ha sido creada correctamente.",life:5e3})),await D(),g.value=!1,x.value=!1,v.value=null,k()}catch(i){const c=((e=(l=i.response)==null?void 0:l.data)==null?void 0:e.message)||"Error al procesar la categor√≠a.";m.add({severity:"error",summary:"Error",detail:c,life:6e3})}},G=l=>{t.value={...l},f.value=!0},J=async()=>{var l,e;try{await _({method:"POST",url:`/api/categorias-productos/${t.value.id}`,data:{_method:"DELETE"}}),await D(),f.value=!1,m.add({severity:"success",summary:"¬°Eliminada!",detail:"La categor√≠a ha sido eliminada correctamente.",life:5e3})}catch(i){f.value=!1;const c=((e=(l=i.response)==null?void 0:l.data)==null?void 0:e.error)||i.message||"Error desconocido";m.add({severity:"error",summary:"Error",detail:`No se pudo eliminar la categor√≠a: ${c}`,life:6e3})}},K=()=>{x.value?h.value=!0:V()},V=()=>{g.value=!1,h.value=!1,x.value=!1,v.value=null,k()},W=()=>{h.value=!1},X=()=>{t.value.nombre&&t.value.nombre.length>50&&(t.value.nombre=t.value.nombre.substring(0,50))};return(l,e)=>{const i=w("Toast"),c=w("InputText"),U=w("Column"),H=w("DataTable"),L=w("Dialog");return T(),E(se,null,[s(o(ae),{title:"Control de Categor√≠as de Productos"}),s(le,null,{default:n(()=>[s(i,{class:"z-[9999]"}),a("div",me,[a("div",ge,[a("div",ve,[s(o(te),{href:l.route("productos"),class:"flex items-center text-blue-600 hover:text-blue-700 transition-colors duration-200 px-4 rounded-lg",title:"Regresar a Productos"},{default:n(()=>[s(o(u),{icon:o(ie),class:"h-8"},null,8,["icon"])]),_:1},8,["href"]),e[7]||(e[7]=a("h3",{class:"text-lg sm:text-2xl text-blue-600 font-bold"},"Control de categor√≠as de productos",-1))]),a("button",{class:"bg-blue-500 border border-blue-500 p-2 text-sm text-white shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:R},[s(o(u),{icon:o(de),class:"h-4 w-4 text-white"},null,8,["icon"]),e[8]||(e[8]=a("span",null,"¬†Agregar categor√≠a",-1))])]),s(H,{value:I.value,dataKey:"id",paginator:!0,rows:N.value,rowsPerPageOptions:z.value,rowsPerPage:N.value,"onUpdate:rowsPerPage":e[1]||(e[1]=r=>N.value=r),paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} categor√≠as",class:"overflow-x-auto max-w-full",style:{display:"block","max-width":"84vw"},responsiveLayout:"scroll"},{header:n(()=>[a("div",be,[s(c,{modelValue:C.value.global.value,"onUpdate:modelValue":e[0]||(e[0]=r=>C.value.global.value=r),placeholder:"üîç Buscar categor√≠as...",class:"w-full h-9 text-sm",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"])])]),default:n(()=>[s(U,{field:"nombre",header:"Nombre",sortable:"",class:"w-96 min-w-96"},{body:n(r=>[a("div",fe,y(r.data.nombre),1)]),_:1}),s(U,{exportable:!1,class:"w-56 min-w-56"},{header:n(()=>e[9]||(e[9]=[a("div",{class:"text-center w-full font-bold"}," Acciones ",-1)])),body:n(r=>[a("div",pe,[a("button",{class:"bg-orange-200/30 border py-2 px-1 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:Q=>B(r.data)},[s(o(u),{icon:o(F),class:"h-4 w-4 text-orange-600"},null,8,["icon"]),e[10]||(e[10]=b(" ¬†Editar "))],8,xe),a("button",{class:"bg-red-200/30 border py-2 px-1 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:Q=>G(r.data)},[s(o(u),{icon:o(ue),class:"h-4 w-4 text-red-600"},null,8,["icon"]),e[11]||(e[11]=b(" ¬†Eliminar "))],8,he)])]),_:1})]),_:1},8,["value","rows","rowsPerPageOptions","rowsPerPage"]),s(L,{visible:g.value,"onUpdate:visible":e[3]||(e[3]=r=>g.value=r),header:P.value+" Categor√≠a",modal:!0,style:{width:"450px"},closable:!1},{footer:n(()=>[a("div",Ee,[a("button",{type:"button",class:"bg-white hover:bg-green-100 text-green-600 border border-green-600 px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:K},[s(o(u),{icon:o(j),class:"h-5 text-green-600"},null,8,["icon"]),e[13]||(e[13]=b(" Cancelar "))]),a("button",{class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:q},[s(o(u),{icon:o(M),class:"h-5 text-white"},null,8,["icon"]),b(" "+y(P.value),1)])])]),default:n(()=>[a("div",we,[a("div",ye,[a("div",Ce,[e[12]||(e[12]=a("label",{for:"nombre",class:"w-24 flex items-center gap-1"},[b(" Nombre: "),a("span",{class:"text-red-500 font-bold"},"*")],-1)),s(c,{modelValue:t.value.nombre,"onUpdate:modelValue":e[2]||(e[2]=r=>t.value.nombre=r),modelModifiers:{trim:!0},id:"nombre",name:"nombre",maxlength:50,class:oe([{"p-invalid":p.value&&(!t.value.nombre||t.value.nombre.length<3||t.value.nombre.length>50)},"flex-1"]),onInput:X,placeholder:"Nombre de la categor√≠a"},null,8,["modelValue","class"])]),t.value.nombre&&t.value.nombre.length<3?(T(),E("small",Pe," El nombre debe tener al menos 3 caracteres. Actual: "+y(t.value.nombre.length)+"/3 ",1)):S("",!0),t.value.nombre&&t.value.nombre.length>=45&&t.value.nombre.length<=50?(T(),E("small",ke," Caracteres restantes: "+y(50-t.value.nombre.length),1)):S("",!0),p.value&&!t.value.nombre?(T(),E("small",_e," El nombre es obligatorio. ")):S("",!0)])])]),_:1},8,["visible","header"]),s(L,{visible:f.value,"onUpdate:visible":e[5]||(e[5]=r=>f.value=r),header:"Eliminar categor√≠a",modal:!0,style:{width:"350px"},closable:!1},{footer:n(()=>[a("div",De,[a("button",{type:"button",class:"bg-white hover:bg-green-100 text-green-600 border border-green-600 px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:e[4]||(e[4]=r=>f.value=!1)},[s(o(u),{icon:o(j),class:"h-5"},null,8,["icon"]),e[17]||(e[17]=a("span",null,"No",-1))]),a("button",{type:"button",class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:J},[s(o(u),{icon:o(M),class:"h-5"},null,8,["icon"]),e[18]||(e[18]=a("span",null,"S√≠",-1))])])]),default:n(()=>[a("div",Te,[s(o(u),{icon:o($),class:"h-8 w-8 text-red-500"},null,8,["icon"]),a("div",Ne,[a("span",null,[e[14]||(e[14]=b("¬øEst√°s seguro de eliminar la categor√≠a: ")),a("b",null,y(t.value.nombre),1),e[15]||(e[15]=b("?"))]),e[16]||(e[16]=a("span",{class:"text-red-600 text-sm font-medium mt-1"},"Esta acci√≥n es irreversible.",-1))])])]),_:1},8,["visible"]),s(L,{visible:h.value,"onUpdate:visible":e[6]||(e[6]=r=>h.value=r),header:"Cambios sin guardar",modal:!0,style:{width:"400px"},closable:!1},{footer:n(()=>[a("div",Ae,[a("button",{type:"button",class:"bg-white hover:bg-green-100 text-green-600 border border-green-600 px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:W},[s(o(u),{icon:o(F),class:"h-4"},null,8,["icon"]),e[20]||(e[20]=a("span",null,"Continuar",-1))]),a("button",{type:"button",class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:V},[s(o(u),{icon:o(ce),class:"h-4"},null,8,["icon"]),e[21]||(e[21]=a("span",null,"Salir sin guardar",-1))])])]),default:n(()=>[a("div",Le,[s(o(u),{icon:o($),class:"h-8 w-8 text-red-500"},null,8,["icon"]),e[19]||(e[19]=a("div",{class:"flex flex-col"},[a("span",null,"¬°Tienes informaci√≥n sin guardar!"),a("span",{class:"text-red-600 text-sm font-medium mt-1"},"¬øDeseas salir sin guardar?")],-1))])]),_:1},8,["visible"])])]),_:1})],64)}}};export{$e as default};
